var OrbitDB=function(t){function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var e={};return n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=76)}([function(t,n,e){"use strict";(function(t){function r(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}function i(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(t,n){if(i()<n)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(n),t.__proto__=u.prototype):(null===t&&(t=new u(n)),t.length=n),t}function u(t,n,e){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,n,e);if("number"==typeof t){if("string"==typeof n)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return s(this,t,n,e)}function s(t,n,e,r){if("number"==typeof n)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer?p(t,n,e,r):"string"==typeof n?h(t,n,e):d(t,n)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function a(t,n,e,r){return c(n),n<=0?o(t,n):void 0!==e?"string"==typeof r?o(t,n).fill(e,r):o(t,n).fill(e):o(t,n)}function f(t,n){if(c(n),t=o(t,n<0?0:0|v(n)),!u.TYPED_ARRAY_SUPPORT)for(var e=0;e<n;++e)t[e]=0;return t}function h(t,n,e){if("string"==typeof e&&""!==e||(e="utf8"),!u.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var r=0|g(n,e);t=o(t,r);var i=t.write(n,e);return i!==r&&(t=t.slice(0,i)),t}function l(t,n){var e=n.length<0?0:0|v(n.length);t=o(t,e);for(var r=0;r<e;r+=1)t[r]=255&n[r];return t}function p(t,n,e,r){if(n.byteLength,e<0||n.byteLength<e)throw new RangeError("'offset' is out of bounds");if(n.byteLength<e+(r||0))throw new RangeError("'length' is out of bounds");return n=void 0===e&&void 0===r?new Uint8Array(n):void 0===r?new Uint8Array(n,e):new Uint8Array(n,e,r),u.TYPED_ARRAY_SUPPORT?(t=n,t.__proto__=u.prototype):t=l(t,n),t}function d(t,n){if(u.isBuffer(n)){var e=0|v(n.length);return t=o(t,e),0===t.length?t:(n.copy(t,0,0,e),t)}if(n){if("undefined"!=typeof ArrayBuffer&&n.buffer instanceof ArrayBuffer||"length"in n)return"number"!=typeof n.length||$(n.length)?o(t,0):l(t,n);if("Buffer"===n.type&&X(n.data))return l(t,n.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function v(t){if(t>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|t}function y(t){return+t!=t&&(t=0),u.alloc(+t)}function g(t,n){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var r=!1;;)switch(n){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return W(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return H(t).length;default:if(r)return W(t).length;n=(""+n).toLowerCase(),r=!0}}function m(t,n,e){var r=!1;if((void 0===n||n<0)&&(n=0),n>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if(e>>>=0,n>>>=0,e<=n)return"";for(t||(t="utf8");;)switch(t){case"hex":return D(this,n,e);case"utf8":case"utf-8":return P(this,n,e);case"ascii":return j(this,n,e);case"latin1":case"binary":return R(this,n,e);case"base64":return S(this,n,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,n,e);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function b(t,n,e){var r=t[n];t[n]=t[e],t[e]=r}function w(t,n,e,r,i){if(0===t.length)return-1;if("string"==typeof e?(r=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=i?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(i)return-1;e=t.length-1}else if(e<0){if(!i)return-1;e=0}if("string"==typeof n&&(n=u.from(n,r)),u.isBuffer(n))return 0===n.length?-1:_(t,n,e,r,i);if("number"==typeof n)return n&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,n,e):Uint8Array.prototype.lastIndexOf.call(t,n,e):_(t,[n],e,r,i);throw new TypeError("val must be string, number or Buffer")}function _(t,n,e,r,i){function o(t,n){return 1===u?t[n]:t.readUInt16BE(n*u)}var u=1,s=t.length,c=n.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||n.length<2)return-1;u=2,s/=2,c/=2,e/=2}var a;if(i){var f=-1;for(a=e;a<s;a++)if(o(t,a)===o(n,f===-1?0:a-f)){if(f===-1&&(f=a),a-f+1===c)return f*u}else f!==-1&&(a-=a-f),f=-1}else for(e+c>s&&(e=s-c),a=e;a>=0;a--){for(var h=!0,l=0;l<c;l++)if(o(t,a+l)!==o(n,l)){h=!1;break}if(h)return a}return-1}function x(t,n,e,r){e=Number(e)||0;var i=t.length-e;r?(r=Number(r),r>i&&(r=i)):r=i;var o=n.length;if(o%2!==0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var u=0;u<r;++u){var s=parseInt(n.substr(2*u,2),16);if(isNaN(s))return u;t[e+u]=s}return u}function E(t,n,e,r){return V(W(n,t.length-e),t,e,r)}function k(t,n,e,r){return V(G(n),t,e,r)}function A(t,n,e,r){return k(t,n,e,r)}function O(t,n,e,r){return V(H(n),t,e,r)}function T(t,n,e,r){return V(J(n,t.length-e),t,e,r)}function S(t,n,e){return 0===n&&e===t.length?Z.fromByteArray(t):Z.fromByteArray(t.slice(n,e))}function P(t,n,e){e=Math.min(t.length,e);for(var r=[],i=n;i<e;){var o=t[i],u=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s<=e){var c,a,f,h;switch(s){case 1:o<128&&(u=o);break;case 2:c=t[i+1],128===(192&c)&&(h=(31&o)<<6|63&c,h>127&&(u=h));break;case 3:c=t[i+1],a=t[i+2],128===(192&c)&&128===(192&a)&&(h=(15&o)<<12|(63&c)<<6|63&a,h>2047&&(h<55296||h>57343)&&(u=h));break;case 4:c=t[i+1],a=t[i+2],f=t[i+3],128===(192&c)&&128===(192&a)&&128===(192&f)&&(h=(15&o)<<18|(63&c)<<12|(63&a)<<6|63&f,h>65535&&h<1114112&&(u=h))}}null===u?(u=65533,s=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=s}return I(r)}function I(t){var n=t.length;if(n<=tt)return String.fromCharCode.apply(String,t);for(var e="",r=0;r<n;)e+=String.fromCharCode.apply(String,t.slice(r,r+=tt));return e}function j(t,n,e){var r="";e=Math.min(t.length,e);for(var i=n;i<e;++i)r+=String.fromCharCode(127&t[i]);return r}function R(t,n,e){var r="";e=Math.min(t.length,e);for(var i=n;i<e;++i)r+=String.fromCharCode(t[i]);return r}function D(t,n,e){var r=t.length;(!n||n<0)&&(n=0),(!e||e<0||e>r)&&(e=r);for(var i="",o=n;o<e;++o)i+=z(t[o]);return i}function B(t,n,e){for(var r=t.slice(n,e),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function C(t,n,e){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+n>e)throw new RangeError("Trying to access beyond buffer length")}function L(t,n,e,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>i||n<o)throw new RangeError('"value" argument is out of bounds');if(e+r>t.length)throw new RangeError("Index out of range")}function M(t,n,e,r){n<0&&(n=65535+n+1);for(var i=0,o=Math.min(t.length-e,2);i<o;++i)t[e+i]=(n&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function U(t,n,e,r){n<0&&(n=4294967295+n+1);for(var i=0,o=Math.min(t.length-e,4);i<o;++i)t[e+i]=n>>>8*(r?i:3-i)&255}function N(t,n,e,r,i,o){if(e+r>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function K(t,n,e,r,i){return i||N(t,n,e,4,3.4028234663852886e38,-3.4028234663852886e38),Q.write(t,n,e,r,23,4),e+4}function F(t,n,e,r,i){return i||N(t,n,e,8,1.7976931348623157e308,-1.7976931348623157e308),Q.write(t,n,e,r,52,8),e+8}function Y(t){if(t=q(t).replace(nt,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function q(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function z(t){return t<16?"0"+t.toString(16):t.toString(16)}function W(t,n){n=n||1/0;for(var e,r=t.length,i=null,o=[],u=0;u<r;++u){if(e=t.charCodeAt(u),e>55295&&e<57344){if(!i){if(e>56319){(n-=3)>-1&&o.push(239,191,189);continue}if(u+1===r){(n-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(n-=3)>-1&&o.push(239,191,189),i=e;continue}e=(i-55296<<10|e-56320)+65536}else i&&(n-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((n-=1)<0)break;o.push(e)}else if(e<2048){if((n-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(e<65536){if((n-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((n-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function G(t){for(var n=[],e=0;e<t.length;++e)n.push(255&t.charCodeAt(e));return n}function J(t,n){for(var e,r,i,o=[],u=0;u<t.length&&!((n-=2)<0);++u)e=t.charCodeAt(u),r=e>>8,i=e%256,o.push(i),o.push(r);return o}function H(t){return Z.toByteArray(Y(t))}function V(t,n,e,r){for(var i=0;i<r&&!(i+e>=n.length||i>=t.length);++i)n[i+e]=t[i];return i}function $(t){return t!==t}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var Z=e(23),Q=e(28),X=e(32);n.Buffer=u,n.SlowBuffer=y,n.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:r(),n.kMaxLength=i(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,n,e){return s(null,t,n,e)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,n,e){return a(null,t,n,e)},u.allocUnsafe=function(t){return f(null,t)},u.allocUnsafeSlow=function(t){return f(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,n){if(!u.isBuffer(t)||!u.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var e=t.length,r=n.length,i=0,o=Math.min(e,r);i<o;++i)if(t[i]!==n[i]){e=t[i],r=n[i];break}return e<r?-1:r<e?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,n){if(!X(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var e;if(void 0===n)for(n=0,e=0;e<t.length;++e)n+=t[e].length;var r=u.allocUnsafe(n),i=0;for(e=0;e<t.length;++e){var o=t[e];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},u.byteLength=g,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var n=0;n<t;n+=2)b(this,n,n+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var n=0;n<t;n+=4)b(this,n,n+3),b(this,n+1,n+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var n=0;n<t;n+=8)b(this,n,n+7),b(this,n+1,n+6),b(this,n+2,n+5),b(this,n+3,n+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?P(this,0,t):m.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,n,e,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=0),void 0===e&&(e=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),n<0||e>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&n>=e)return 0;if(r>=i)return-1;if(n>=e)return 1;if(n>>>=0,e>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var o=i-r,s=e-n,c=Math.min(o,s),a=this.slice(r,i),f=t.slice(n,e),h=0;h<c;++h)if(a[h]!==f[h]){o=a[h],s=f[h];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,n,e){return this.indexOf(t,n,e)!==-1},u.prototype.indexOf=function(t,n,e){return w(this,t,n,e,!0)},u.prototype.lastIndexOf=function(t,n,e){return w(this,t,n,e,!1)},u.prototype.write=function(t,n,e,r){if(void 0===n)r="utf8",e=this.length,n=0;else if(void 0===e&&"string"==typeof n)r=n,e=this.length,n=0;else{if(!isFinite(n))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");n|=0,isFinite(e)?(e|=0,void 0===r&&(r="utf8")):(r=e,e=void 0)}var i=this.length-n;if((void 0===e||e>i)&&(e=i),t.length>0&&(e<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return x(this,t,n,e);case"utf8":case"utf-8":return E(this,t,n,e);case"ascii":return k(this,t,n,e);case"latin1":case"binary":return A(this,t,n,e);case"base64":return O(this,t,n,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,n,e);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var tt=4096;u.prototype.slice=function(t,n){var e=this.length;t=~~t,n=void 0===n?e:~~n,t<0?(t+=e,t<0&&(t=0)):t>e&&(t=e),n<0?(n+=e,n<0&&(n=0)):n>e&&(n=e),n<t&&(n=t);var r;if(u.TYPED_ARRAY_SUPPORT)r=this.subarray(t,n),r.__proto__=u.prototype;else{var i=n-t;r=new u(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+t]}return r},u.prototype.readUIntLE=function(t,n,e){t|=0,n|=0,e||C(t,n,this.length);for(var r=this[t],i=1,o=0;++o<n&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,n,e){t|=0,n|=0,e||C(t,n,this.length);for(var r=this[t+--n],i=1;n>0&&(i*=256);)r+=this[t+--n]*i;return r},u.prototype.readUInt8=function(t,n){return n||C(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,n){return n||C(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,n){return n||C(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,n){return n||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,n){return n||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,n,e){t|=0,n|=0,e||C(t,n,this.length);for(var r=this[t],i=1,o=0;++o<n&&(i*=256);)r+=this[t+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*n)),r},u.prototype.readIntBE=function(t,n,e){t|=0,n|=0,e||C(t,n,this.length);for(var r=n,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*n)),o},u.prototype.readInt8=function(t,n){return n||C(t,1,this.length),128&this[t]?(255-this[t]+1)*-1:this[t]},u.prototype.readInt16LE=function(t,n){n||C(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},u.prototype.readInt16BE=function(t,n){n||C(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},u.prototype.readInt32LE=function(t,n){return n||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,n){return n||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,n){return n||C(t,4,this.length),Q.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,n){return n||C(t,4,this.length),Q.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,n){return n||C(t,8,this.length),Q.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,n){return n||C(t,8,this.length),Q.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,n,e,r){if(t=+t,n|=0,e|=0,!r){var i=Math.pow(2,8*e)-1;L(this,t,n,e,i,0)}var o=1,u=0;for(this[n]=255&t;++u<e&&(o*=256);)this[n+u]=t/o&255;return n+e},u.prototype.writeUIntBE=function(t,n,e,r){if(t=+t,n|=0,e|=0,!r){var i=Math.pow(2,8*e)-1;L(this,t,n,e,i,0)}var o=e-1,u=1;for(this[n+o]=255&t;--o>=0&&(u*=256);)this[n+o]=t/u&255;return n+e},u.prototype.writeUInt8=function(t,n,e){return t=+t,n|=0,e||L(this,t,n,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=255&t,n+1},u.prototype.writeUInt16LE=function(t,n,e){return t=+t,n|=0,e||L(this,t,n,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):M(this,t,n,!0),n+2},u.prototype.writeUInt16BE=function(t,n,e){return t=+t,n|=0,e||L(this,t,n,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):M(this,t,n,!1),n+2},u.prototype.writeUInt32LE=function(t,n,e){return t=+t,n|=0,e||L(this,t,n,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t):U(this,t,n,!0),n+4},u.prototype.writeUInt32BE=function(t,n,e){return t=+t,n|=0,e||L(this,t,n,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):U(this,t,n,!1),n+4},u.prototype.writeIntLE=function(t,n,e,r){if(t=+t,n|=0,!r){var i=Math.pow(2,8*e-1);L(this,t,n,e,i-1,-i)}var o=0,u=1,s=0;for(this[n]=255&t;++o<e&&(u*=256);)t<0&&0===s&&0!==this[n+o-1]&&(s=1),this[n+o]=(t/u>>0)-s&255;return n+e},u.prototype.writeIntBE=function(t,n,e,r){if(t=+t,n|=0,!r){var i=Math.pow(2,8*e-1);L(this,t,n,e,i-1,-i)}var o=e-1,u=1,s=0;for(this[n+o]=255&t;--o>=0&&(u*=256);)t<0&&0===s&&0!==this[n+o+1]&&(s=1),this[n+o]=(t/u>>0)-s&255;return n+e},u.prototype.writeInt8=function(t,n,e){return t=+t,n|=0,e||L(this,t,n,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[n]=255&t,n+1},u.prototype.writeInt16LE=function(t,n,e){return t=+t,n|=0,e||L(this,t,n,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):M(this,t,n,!0),n+2},u.prototype.writeInt16BE=function(t,n,e){return t=+t,n|=0,e||L(this,t,n,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):M(this,t,n,!1),n+2},u.prototype.writeInt32LE=function(t,n,e){return t=+t,n|=0,e||L(this,t,n,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):U(this,t,n,!0),n+4},u.prototype.writeInt32BE=function(t,n,e){return t=+t,n|=0,e||L(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):U(this,t,n,!1),n+4},u.prototype.writeFloatLE=function(t,n,e){return K(this,t,n,!0,e)},u.prototype.writeFloatBE=function(t,n,e){return K(this,t,n,!1,e)},u.prototype.writeDoubleLE=function(t,n,e){return F(this,t,n,!0,e)},u.prototype.writeDoubleBE=function(t,n,e){return F(this,t,n,!1,e)},u.prototype.copy=function(t,n,e,r){if(e||(e=0),r||0===r||(r=this.length),n>=t.length&&(n=t.length),n||(n=0),r>0&&r<e&&(r=e),r===e)return 0;if(0===t.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-n<r-e&&(r=t.length-n+e);var i,o=r-e;if(this===t&&e<n&&n<r)for(i=o-1;i>=0;--i)t[i+n]=this[i+e];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+n]=this[i+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+o),n);return o},u.prototype.fill=function(t,n,e,r){if("string"==typeof t){if("string"==typeof n?(r=n,n=0,e=this.length):"string"==typeof e&&(r=e,e=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(n<0||this.length<n||this.length<e)throw new RangeError("Out of range index");if(e<=n)return this;n>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0);var o;if("number"==typeof t)for(o=n;o<e;++o)this[o]=t;else{var s=u.isBuffer(t)?t:W(new u(t,r).toString()),c=s.length;for(o=0;o<e-n;++o)this[o+n]=s[o%c]}return this};var nt=/[^+\/0-9A-Za-z-_]/g}).call(n,e(4))},function(t,n,e){"use strict";t.exports=function(t,n){function e(o){return r=o,i?e.abort():void function e(){for(var o=!0,u=!1;o;)if(u=!1,r(null,function(s,c){if(u=!0,s=s||i){if(o=!1,n)n(s===!0?null:s);else if(s&&s!==!0)throw s}else t&&!1===t(c)||i?(o=!1,r(i||!0,n||function(){})):o||e()}),!u)return void(o=!1)}()}var r,i;return e.abort=function(t,n){if("function"==typeof t&&(n=t,t=!0),i=t||!0,r)return r(i,n||function(){})},e}},function(t,n){t.exports=function(t){return t&&("string"==typeof t?function(n){return n[t]}:"object"==typeof t&&"function"==typeof t.exec?function(n){var e=t.exec(n);return e&&e[0]}:t)}},function(t,n,e){"use strict";(function(n){const r=e(5).EventEmitter,i=e(30),o=e(36),u=e(43),s={Index:u,maxHistory:256,cachePath:"./orbit-db"};class c{constructor(t,n,e,u){this.id=n,this.dbname=e||"",this.events=new r;let c=Object.assign({},s);Object.assign(c,u),this.options=c,this._ipfs=t,this._index=new this.options.Index(this.id),this._oplog=i.create(this.id),this._lastWrite=[],this._cache=new o(this.options.cachePath,this.dbname),this.sending=!1,this.q=[],setInterval(()=>this._processQ(),16)}load(){return this._cache.load().then(()=>this._cache.get(this.dbname)).then(t=>{return t?(this.events.emit("sync",this.dbname),i.fromMultihash(this._ipfs,t,this.options.maxHistory).then(t=>{this._oplog=t,this._index.updateIndex(this._oplog)})):Promise.resolve()}).then(()=>this.events.emit("ready"))}loadMore(t){this._oplog.items.length;return this.events.emit("sync",this.dbname),i.expand(this._ipfs,this._oplog,t).then(t=>{this._oplog=t,this._index.updateIndex(this._oplog),this.events.emit("synced",this.dbname)})}sync(t){this.q.splice(0,0,t)}_processQ(){if(this.q&&this.q.length>0&&!this.sending){this.sending=!0;const t=this.q.shift();this._syncFromHeads(t).then(()=>this.sending=!1).catch(t=>this.events.emit("error",t))}}_syncFromHeads(t,e=-1){const r=this._oplog.items.map(t=>t.hash);if(r.find(n=>t.map(t=>t.hash).indexOf(n)>-1))return Promise.resolve();this.events.emit("sync",this.dbname);const o=t=>{const e=Object.assign({},t);return e.hash=null,this._ipfs.object.put(new n(JSON.stringify(e))).then(t=>t.toJSON().multihash)};return Promise.all(t.map(t=>o(t))).then(n=>{return i.fromEntry(this._ipfs,t,this.options.maxHistory,r,this._onLoadProgress.bind(this))}).then(t=>{this._oplog.items.length;t.items.length>0&&(this._oplog=i.join(this._oplog,t,e,this._oplog.id),this._index.updateIndex(this._oplog))}).then(()=>i.toMultihash(this._ipfs,this._oplog)).then(t=>{return this._cache.set(this.dbname,t).then(()=>{return this.events.emit("synced",this.dbname),t})}).catch(t=>this.events.emit("error",t))}_addOperation(t){let n;if(this._oplog)return i.append(this._ipfs,this._oplog,t).then(t=>{this._oplog=t}).then(()=>i.toMultihash(this._ipfs,this._oplog)).then(t=>n=t).then(()=>this._cache.set(this.dbname,n)).then(()=>{const t=this._oplog.items[this._oplog.items.length-1];this._lastWrite.push(n),this._index.updateIndex(this._oplog);const e=this._oplog.heads.map(t=>this._oplog.get(t));return this.events.emit("write",this.dbname,n,t,e),t.hash})}_onLoadProgress(t,n,e,r){this.events.emit("load.progress",this.dbname,r)}}t.exports=c}).call(n,e(0).Buffer)},function(t,n){var e;e=function(){return this}();try{e=e||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(e=window)}t.exports=e},function(t,n){function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function i(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function u(t){return void 0===t}t.exports=e,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(t){if(!i(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},e.prototype.emit=function(t){var n,e,i,s,c,a;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(n=arguments[1],n instanceof Error)throw n;var f=new Error('Uncaught, unspecified "error" event. ('+n+")");throw f.context=n,f}if(e=this._events[t],u(e))return!1;if(r(e))switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),e.apply(this,s)}else if(o(e))for(s=Array.prototype.slice.call(arguments,1),a=e.slice(),i=a.length,c=0;c<i;c++)a[c].apply(this,s);return!0},e.prototype.addListener=function(t,n){var i;if(!r(n))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(n.listener)?n.listener:n),this._events[t]?o(this._events[t])?this._events[t].push(n):this._events[t]=[this._events[t],n]:this._events[t]=n,o(this._events[t])&&!this._events[t].warned&&(i=u(this._maxListeners)?e.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(t,n){function e(){this.removeListener(t,e),i||(i=!0,n.apply(this,arguments))}if(!r(n))throw TypeError("listener must be a function");var i=!1;return e.listener=n,this.on(t,e),this},e.prototype.removeListener=function(t,n){var e,i,u,s;if(!r(n))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(e=this._events[t],u=e.length,i=-1,e===n||r(e.listener)&&e.listener===n)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,n);else if(o(e)){for(s=u;s-- >0;)if(e[s]===n||e[s].listener&&e[s].listener===n){i=s;break}if(i<0)return this;1===e.length?(e.length=0,delete this._events[t]):e.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,n)}return this},e.prototype.removeAllListeners=function(t){var n,e;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(n in this._events)"removeListener"!==n&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[t],r(e))this.removeListener(t,e);else if(e)for(;e.length;)this.removeListener(t,e[e.length-1]);return delete this._events[t],this},e.prototype.listeners=function(t){var n;return n=this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},e.prototype.listenerCount=function(t){if(this._events){var n=this._events[t];if(r(n))return 1;if(n)return n.length}return 0},e.listenerCount=function(t,n){return t.listenerCount(n)}},function(t,n,e){function r(t,n){this._id=t,this._clearFn=n}var i=Function.prototype.apply;n.setTimeout=function(){return new r(i.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new r(i.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},n.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},n._unrefActive=n.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;n>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},n))},e(70),n.setImmediate=setImmediate,n.clearImmediate=clearImmediate},function(t,n){function e(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(t){if(f===setTimeout)return setTimeout(t,0);if((f===e||!f)&&setTimeout)return f=setTimeout,setTimeout(t,0);try{return f(t,0)}catch(n){try{return f.call(null,t,0)}catch(n){return f.call(this,t,0)}}}function o(t){if(h===clearTimeout)return clearTimeout(t);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(n){try{return h.call(null,t)}catch(n){return h.call(this,t)}}}function u(){v&&p&&(v=!1,p.length?d=p.concat(d):y=-1,d.length&&s())}function s(){if(!v){var t=i(u);v=!0;for(var n=d.length;n;){for(p=d,d=[];++y<n;)p&&p[y].run();y=-1,n=d.length}p=null,v=!1,o(t)}}function c(t,n){this.fun=t,this.array=n}function a(){}var f,h,l=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:e}catch(t){f=e}try{h="function"==typeof clearTimeout?clearTimeout:r}catch(t){h=r}}();var p,d=[],v=!1,y=-1;l.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];d.push(new c(t,n)),1!==d.length||v||i(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=a,l.addListener=a,l.once=a,l.off=a,l.removeListener=a,l.removeAllListeners=a,l.emit=a,l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(t,n,e){"use strict";var r=e(1);t.exports=function(t,n,e){e||(e=n,n=null);var i=r(function(e){n=t(n,e)},function(t){e(t,n)});return 2===arguments.length?function(t){t(null,function(r,o){return r?e(r===!0?null:r):(n=o,void i(t))})}:i}},function(t,n,e){"use strict";var r=e(16);t.exports=function(t,n){if(!t)return function(t,e){return t?r(e,t,n):e(!0)};Array.isArray(t)||(t=Object.keys(t).map(function(n){return t[n]}));var e=0;return function(i,o){return i?r(o,i,n):void(e>=t.length?o(!0):o(null,t[e++]))}}},function(t,n,e){"use strict";var r=e(17);t.exports=function(t){return t=r(t),function(n){return function e(r,i){for(var o,u=!0;u;)u=!1,o=!0,n(r,function(n,r){return n||t(r)?void i(n,r):o?u=!0:e(n,i)}),o=!1}}}},function(t,n,e){"use strict";const r=e(3),i=e(39);class o extends r{constructor(t,n,e,r={}){void 0===r.Index&&Object.assign(r,{Index:i}),super(t,n,e,r)}add(t){return this._addOperation({op:"ADD",key:null,value:t})}get(t){return this.iterator({gte:t,limit:1}).collect()[0]}iterator(t){const n=this._query(t);let e=0,r={[Symbol.iterator](){return this},next(){let t={value:null,done:!0};return e<n.length&&(t={value:n[e],done:!1},e++),t},collect:()=>n};return r}_query(t){t||(t={});const n=t.limit?t.limit>-1?t.limit:this._index.get().length:1,e=this._index.get().slice();let r=[];return r=t.gt||t.gte?this._read(e,t.gt?t.gt:t.gte,n,!!t.gte):this._read(e.reverse(),t.lt?t.lt:t.lte,n,t.lte||!t.lt).reverse()}_read(t,n,e,r){const i=t.map(t=>t.hash).indexOf(n);let o=Math.max(i,0);o+=r?0:1;const u=t.slice(o).slice(0,e);return u}}t.exports=o},function(t,n,e){"use strict";(function(n){const e=new Error("Ipfs instance not defined");class r{static create(t,n,i=null,o=[]){if(!t)throw e;if(!n)throw new Error("Entry requires an id");if(!o||!Array.isArray(o))throw new Error("'next' argument is not an array");let u=o.filter(t=>void 0!==t&&null!==t).map(t=>t.hash?t.hash:t),s={hash:null,id:n,payload:i,next:u};return r.toMultihash(t,s).then(t=>{return s.hash=t,s})}static toMultihash(t,r){if(!t)throw e;const i=new n(JSON.stringify(r));return t.object.put(i).then(t=>t.toJSON().multihash)}static fromMultihash(t,n){if(!t)throw e;if(!n)throw new Error(`Invalid hash: ${n}`);return t.object.get(n,{enc:"base58"}).then(t=>JSON.parse(t.toJSON().data)).then(t=>{const e={hash:n,id:t.id,payload:t.payload,next:t.next};return e})}static hasChild(t,n){return t.next.indexOf(n.hash)>-1}static isEntry(t){return void 0!==t.id&&void 0!==t.next&&void 0!==t.hash&&void 0!==t.payload}static isEqual(t,n){return t.hash===n.hash}static findParents(t,n){let e=[],i=n.find(n=>r.hasChild(n,t)),o=t;for(;i;)e.push(i),o=i,i=n.find(t=>r.hasChild(t,o));return e}}t.exports=r}).call(n,e(0).Buffer)},function(t,n,e){"use strict";var r=e(57),i=e(51),o=e(63);n=t.exports=e(47);for(var u in r)n[u]=r[u];for(var u in o)n[u]=o[u];for(var u in i)n[u]=i[u]},function(t,n,e){"use strict";var r=e(16);t.exports=function(t,n){return function(e,i){if(e)return r(i,e,n);if(null!=t){var o=t;t=null,i(null,o)}else i(!0)}}},function(t,n,e){"use strict";function r(t){return t}var i=e(2),o=e(10);t.exports=function(t,n){t=i(t)||r;var e={};return o(function(r){var i=t(r);return e[i]?!!n:(e[i]=!0,!n)})}},function(t,n){t.exports=function(t,n,e){t(n),e&&e(n===!0?null:n)}},function(t,n,e){function r(t){return t}var i=e(2);t.exports=function(t){return"object"==typeof t&&"function"==typeof t.test?function(n){return t.test(n)}:i(t)||r}},function(t,n,e){"use strict";const r=e(3),i=e(37);class o extends r{constructor(t,n,e,r={}){r.Index||Object.assign(r,{Index:i}),super(t,n,e,r)}get value(){return this._index.get().value}inc(t){const n=this._index.get();if(n)return n.increment(t),this._addOperation({op:"COUNTER",key:null,value:n.payload,meta:{ts:(new Date).getTime()}})}}t.exports=o},function(t,n,e){"use strict";const r=e(3),i=e(38);class o extends r{constructor(t,n,e,r){r||(r={}),r.indexBy||Object.assign(r,{indexBy:"_id"}),r.Index||Object.assign(r,{Index:i}),super(t,n,e,r)}get(t){return Object.keys(this._index._index).filter(n=>n.indexOf(t)!==-1).map(t=>this._index.get(t))}query(t){return Object.keys(this._index._index).map(t=>this._index.get(t)).filter(n=>t(n))}put(t){return this._addOperation({op:"PUT",key:t[this.options.indexBy],value:t})}del(t){return this._addOperation({op:"DEL",key:t,value:null})}}t.exports=o},function(t,n,e){"use strict";const r=e(11),i=e(40);class o extends r{constructor(t,n,e,r){r||(r={}),r.Index||Object.assign(r,{Index:i}),super(t,n,e,r)}remove(t){const n={op:"DEL",key:null,value:t};return this._addOperation(n)}}t.exports=o},function(t,n,e){"use strict";const r=e(3),i=e(41);class o extends r{constructor(t,n,e,r){let o=Object.assign({},{Index:i});Object.assign(o,r),super(t,n,e,o)}get(t){return this._index.get(t)}set(t,n){return this.put(t,n)}put(t,n){return this._addOperation({op:"PUT",key:t,value:n})}del(t){return this._addOperation({op:"DEL",key:t,value:null})}}t.exports=o},function(t,n,e){t.exports=e(42)},function(t,n,e){"use strict";function r(t){var n=t.length;if(n%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[n-2]?2:"="===t[n-1]?1:0}function i(t){return 3*t.length/4-r(t)}function o(t){var n,e,i,o,u,s,c=t.length;u=r(t),s=new h(3*c/4-u),i=u>0?c-4:c;var a=0;for(n=0,e=0;n<i;n+=4,e+=3)o=f[t.charCodeAt(n)]<<18|f[t.charCodeAt(n+1)]<<12|f[t.charCodeAt(n+2)]<<6|f[t.charCodeAt(n+3)],s[a++]=o>>16&255,s[a++]=o>>8&255,s[a++]=255&o;return 2===u?(o=f[t.charCodeAt(n)]<<2|f[t.charCodeAt(n+1)]>>4,s[a++]=255&o):1===u&&(o=f[t.charCodeAt(n)]<<10|f[t.charCodeAt(n+1)]<<4|f[t.charCodeAt(n+2)]>>2,s[a++]=o>>8&255,s[a++]=255&o),s}function u(t){return a[t>>18&63]+a[t>>12&63]+a[t>>6&63]+a[63&t]}function s(t,n,e){for(var r,i=[],o=n;o<e;o+=3)r=(t[o]<<16)+(t[o+1]<<8)+t[o+2],i.push(u(r));return i.join("")}function c(t){for(var n,e=t.length,r=e%3,i="",o=[],u=16383,c=0,f=e-r;c<f;c+=u)o.push(s(t,c,c+u>f?f:c+u));return 1===r?(n=t[e-1],i+=a[n>>2],i+=a[n<<4&63],i+="=="):2===r&&(n=(t[e-2]<<8)+t[e-1],i+=a[n>>10],i+=a[n>>4&63],i+=a[n<<2&63],i+="="),o.push(i),o.join("")}n.byteLength=i,n.toByteArray=o,n.fromByteArray=c;for(var a=[],f=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,d=l.length;p<d;++p)a[p]=l[p],f[l.charCodeAt(p)]=p;f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63},function(t,n,e){"use strict";const r=e(25).isEqual;class i{constructor(t,n){this.id=t,this._counters=n?n:{},this._counters[this.id]=this._counters[this.id]?this._counters[this.id]:0}increment(t){t||(t=1),this._counters[this.id]=this._counters[this.id]+t}get value(){return Object.keys(this._counters).map(t=>this._counters[t]).reduce((t,n)=>t+n,0)}get payload(){return{id:this.id,counters:this._counters}}compare(t){return t.id===this.id&&r(t._counters,this._counters)}merge(t){Object.keys(t._counters).forEach(n=>{this._counters[n]=Math.max(this._counters[n]?this._counters[n]:0,t._counters[n])})}static from(t){return new i(t.id,t.counters)}}t.exports=i},function(t,n,e){"use strict";n.isEqual=((t,n)=>{const e=Object.getOwnPropertyNames(t),r=Object.getOwnPropertyNames(n);if(e.length!==r.length)return!1;for(let i=0;i<e.length;i++){const r=e[i];if(t[r]!==n[r])return!1}return!0})},function(t,n,e){(function(n,e){!function(n,e){t.exports=e()}(this,function(){"use strict";function t(t,n){return"object"!=typeof n?t:(Ot(n).forEach(function(e){t[e]=n[e]}),t)}function r(t,n){return It.call(t,n)}function i(t,n){"function"==typeof n&&(n=n(Pt(t))),Ot(n).forEach(function(e){o(t,e,n[e])})}function o(n,e,i,o){Object.defineProperty(n,e,t(i&&r(i,"get")&&"function"==typeof i.get?{get:i.get,set:i.set,configurable:!0}:{value:i,configurable:!0,writable:!0},o))}function u(t){return{from:function(n){return t.prototype=Object.create(n.prototype),o(t.prototype,"constructor",t),{extend:i.bind(null,t.prototype)}}}}function s(t,n){var e,r=jt(t,n);return r||(e=Pt(t))&&s(e,n)}function c(t,n,e){return Rt.call(t,n,e)}function a(t,n){return n(t)}function f(t){var n=setTimeout(t,1e3);clearTimeout(n)}function h(t){if(!t)throw new Error("Assertion Failed")}function l(t){St.setImmediate?e(t):setTimeout(t,0)}function p(t,n){return t.reduce(function(t,e,r){var i=n(e,r);return i&&(t[i[0]]=i[1]),t},{})}function d(t,n){return function(){try{t.apply(this,arguments)}catch(t){n(t)}}}function v(t,n,e){try{t.apply(null,e)}catch(t){n&&n(t)}}function y(t,n){if(r(t,n))return t[n];if(!n)return t;if("string"!=typeof n){for(var e=[],i=0,o=n.length;i<o;++i){var u=y(t,n[i]);e.push(u)}return e}var s=n.indexOf(".");if(s!==-1){var c=t[n.substr(0,s)];return void 0===c?void 0:y(c,n.substr(s+1))}}function g(t,n,e){if(t&&void 0!==n&&!("isFrozen"in Object&&Object.isFrozen(t)))if("string"!=typeof n&&"length"in n){h("string"!=typeof e&&"length"in e);for(var r=0,i=n.length;r<i;++r)g(t,n[r],e[r])}else{var o=n.indexOf(".");if(o!==-1){var u=n.substr(0,o),s=n.substr(o+1);if(""===s)void 0===e?delete t[u]:t[u]=e;else{var c=t[u];c||(c=t[u]={}),g(c,s,e)}}else void 0===e?delete t[n]:t[n]=e}}function m(t,n){"string"==typeof n?g(t,n,void 0):"length"in n&&[].map.call(n,function(n){g(t,n,void 0)})}function b(t){var n={};for(var e in t)r(t,e)&&(n[e]=t[e]);return n}function w(t){if(!t||"object"!=typeof t)return t;var n;if(Tt(t)){n=[];for(var e=0,i=t.length;e<i;++e)n.push(w(t[e]))}else if(t instanceof Date)n=new Date,n.setTime(t.getTime());else{n=t.constructor?Object.create(t.constructor.prototype):{};for(var o in t)r(t,o)&&(n[o]=w(t[o]))}return n}function _(t,n,e,i){return e=e||{},i=i||"",Ot(t).forEach(function(o){if(r(n,o)){var u=t[o],s=n[o];"object"==typeof u&&"object"==typeof s&&u&&s&&u.constructor===s.constructor?_(u,s,e,i+o+"."):u!==s&&(e[i+o]=n[o])}else e[i+o]=void 0}),Ot(n).forEach(function(o){r(t,o)||(e[i+o]=n[o])}),e}function x(t){var n,e,r,i;if(1===arguments.length){if(Tt(t))return t.slice();if(this===Ct&&"string"==typeof t)return[t];if(i=Bt(t)){for(e=[];r=i.next(),!r.done;)e.push(r.value);return e}if(null==t)return[t];if(n=t.length,"number"==typeof n){for(e=new Array(n);n--;)e[n]=t[n];return e}return[t]}for(n=arguments.length,e=new Array(n);n--;)e[n]=arguments[n];return e}function E(t){return Lt.apply([],t)}function k(){}function A(t){return t}function O(t,n){return null==t||t===A?n:function(e){return n(t(e))}}function T(t,n){return function(){t.apply(this,arguments),n.apply(this,arguments)}}function S(t,n){return t===k?n:function(){var e=t.apply(this,arguments);void 0!==e&&(arguments[0]=e);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=n.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?T(r,this.onsuccess):r),i&&(this.onerror=this.onerror?T(i,this.onerror):i),void 0!==o?o:e}}function P(t,n){return t===k?n:function(){t.apply(this,arguments);var e=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,n.apply(this,arguments),e&&(this.onsuccess=this.onsuccess?T(e,this.onsuccess):e),r&&(this.onerror=this.onerror?T(r,this.onerror):r)}}function I(n,e){return n===k?e:function(r){var i=n.apply(this,arguments);t(r,i);var o=this.onsuccess,u=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?T(o,this.onsuccess):o),u&&(this.onerror=this.onerror?T(u,this.onerror):u),void 0===i?void 0===s?void 0:s:t(i,s)}}function j(t,n){return t===k?n:function(){return n.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function R(t,n){return t===k?n:function(){var e=t.apply(this,arguments);if(e&&"function"==typeof e.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return e.then(function(){return n.apply(r,o)})}return n.apply(this,arguments)}}function D(t,n){Mt=t,Ut=n}function B(){if(Nt)try{throw B.arguments,new Error}catch(t){return t}return new Error}function C(t,n){
var e=t.stack;return e?(n=n||0,0===e.indexOf(t.name)&&(n+=(t.name+t.message).split("\n").length),e.split("\n").slice(n).filter(Ut).map(function(t){return"\n"+t}).join("")):""}function L(t,n){return function(){return console.warn(t+" is deprecated. See https://github.com/dfahlander/Dexie.js/wiki/Deprecations. "+C(B(),1)),n.apply(this,arguments)}}function M(t,n){this._e=B(),this.name=t,this.message=n}function U(t,n){return t+". Errors: "+n.map(function(t){return t.toString()}).filter(function(t,n,e){return e.indexOf(t)===n}).join("\n")}function N(t,n,e,r){this._e=B(),this.failures=n,this.failedKeys=r,this.successCount=e}function K(t,n){this._e=B(),this.name="BulkError",this.failures=n,this.message=U(t,n)}function F(t,n){if(!t||t instanceof M||t instanceof TypeError||t instanceof SyntaxError||!t.name||!Jt[t.name])return t;var e=new Jt[t.name](n||t.message,t);return"stack"in t&&o(e,"stack",{get:function(){return this.inner.stack}}),e}function Y(t){function n(t,n,o){if("object"==typeof t)return e(t);n||(n=j),o||(o=k);var u={subscribers:[],fire:o,subscribe:function(t){u.subscribers.indexOf(t)===-1&&(u.subscribers.push(t),u.fire=n(u.fire,t))},unsubscribe:function(t){u.subscribers=u.subscribers.filter(function(n){return n!==t}),u.fire=u.subscribers.reduce(n,o)}};return r[t]=i[t]=u,u}function e(t){Ot(t).forEach(function(e){var r=t[e];if(Tt(r))n(e,t[e][0],t[e][1]);else{if("asap"!==r)throw new Gt.InvalidArgument("Invalid event config");var i=n(e,A,function(){for(var t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];i.subscribers.forEach(function(t){l(function(){t.apply(null,n)})})})}})}var r={},i=function(n,e){if(e){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return r[n].subscribe.apply(null,o),t}if("string"==typeof n)return r[n]};i.addEventType=n;for(var o=1,u=arguments.length;o<u;++o)n(arguments[o]);return i}function q(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=k,this._lib=!1;var n=this._PSD=an;if(Mt&&(this._stackHolder=B(),this._prev=null,this._numPrev=0,Z(this,un)),"function"!=typeof t){if(t!==Vt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&G(this,this._value))}this._state=null,this._value=null,++n.ref,W(this,t)}function z(t,n,e,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=r,this.psd=an}function W(t,n){try{n(function(n){if(null===t._state){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var e=t._lib&&X();n&&"function"==typeof n.then?W(t,function(t,e){n instanceof q?n._then(t,e):n.then(t,e)}):(t._state=!0,t._value=n,J(t)),e&&tt()}},G.bind(null,t))}catch(n){G(t,n)}}function G(t,n){if(on.push(n),null===t._state){var e=t._lib&&X();n=sn(n),t._state=!1,t._value=n,Mt&&null!==n&&"object"==typeof n&&!n._promise&&v(function(){var e=s(n,"stack");n._promise=t,o(n,"stack",{get:function(){return Qt?e&&(e.get?e.get.apply(n):e.value):t.stack}})}),rt(t),J(t),e&&tt()}}function J(t){var n=t._listeners;t._listeners=[];for(var e=0,r=n.length;e<r;++e)H(t,n[e]);var i=t._PSD;--i.ref||i.finalize(),0===hn&&(++hn,tn(function(){0===--hn&&nt()},[]))}function H(t,n){if(null===t._state)return void t._listeners.push(n);var e=t._state?n.onFulfilled:n.onRejected;if(null===e)return(t._state?n.resolve:n.reject)(t._value);var r=n.psd;++r.ref,++hn,tn(V,[e,t,n])}function V(t,n,e){var r=an,i=e.psd;try{i!==r&&(an=i),un=n;var o,u=n._value;n._state?o=t(u):(on.length&&(on=[]),o=t(u),on.indexOf(u)===-1&&it(n)),e.resolve(o)}catch(t){e.reject(t)}finally{i!==r&&(an=r),un=null,0===--hn&&nt(),--i.ref||i.finalize()}}function $(t,n,e){if(n.length===e)return n;var r="";if(t._state===!1){var i,o,u=t._value;null!=u?(i=u.name||"Error",o=u.message||u,r=C(u,0)):(i=u,o=""),n.push(i+(o?": "+o:"")+r)}return Mt&&(r=C(t._stackHolder,2),r&&n.indexOf(r)===-1&&n.push(r),t._prev&&$(t._prev,n,e)),n}function Z(t,n){var e=n?n._numPrev+1:0;e<$t&&(t._prev=n,t._numPrev=e)}function Q(){X()&&tt()}function X(){var t=nn;return nn=!1,en=!1,t}function tt(){var t,n,e;do for(;fn.length>0;)for(t=fn,fn=[],e=t.length,n=0;n<e;++n){var r=t[n];r[0].apply(null,r[1])}while(fn.length>0);nn=!0,en=!0}function nt(){var t=rn;rn=[],t.forEach(function(t){t._PSD.onunhandled.call(null,t._value,t)});for(var n=ln.slice(0),e=n.length;e;)n[--e]()}function et(t){function n(){t(),ln.splice(ln.indexOf(n),1)}ln.push(n),++hn,tn(function(){0===--hn&&nt()},[])}function rt(t){rn.some(function(n){return n._value===t._value})||rn.push(t)}function it(t){for(var n=rn.length;n;)if(rn[--n]._value===t._value)return void rn.splice(n,1)}function ot(t){console.warn("Unhandled rejection: "+(t.stack||t))}function ut(t){return new q(Vt,!1,t)}function st(t,n){var e=an;return function(){var r=X(),i=an;try{return i!==e&&(an=e),t.apply(this,arguments)}catch(t){n&&n(t)}finally{i!==e&&(an=i),r&&tt()}}}function ct(t,n,e,r){var i=an,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=at(o,t,n,e,r);return 0===o.ref&&o.finalize(),u}function at(t,n,e,r,i){var o=an;try{return t!==o&&(an=t),n(e,r,i)}finally{t!==o&&(an=o)}}function ft(n,e){var r;try{r=e.onuncatched(n)}catch(t){}if(r!==!1)try{var i,o={promise:e,reason:n};if(St.document&&document.createEvent?(i=document.createEvent("Event"),i.initEvent(dn,!0,!0),t(i,o)):St.CustomEvent&&(i=new CustomEvent(dn,{detail:o}),t(i,o)),i&&St.dispatchEvent&&(dispatchEvent(i),!St.PromiseRejectionEvent&&St.onunhandledrejection))try{St.onunhandledrejection(i)}catch(t){}i.defaultPrevented||q.on.error.fire(n,e)}catch(t){}}function ht(t,n){var e=q.reject(t);return n?e.uncaught(n):e}function lt(n,e){function s(){rn.on("versionchange",function(t){t.newVersion>0?console.warn("Another connection wants to upgrade database '"+rn.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+rn.name+"'. Closing db now to resume the delete request."),rn.close()}),rn.on("blocked",function(t){!t.newVersion||t.newVersion<t.oldVersion?console.warn("Dexie.delete('"+rn.name+"') was blocked"):console.warn("Upgrade '"+rn.name+"' blocked by other connection holding version "+t.oldVersion/10)})}function l(t){this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function m(t,n,e){var r=rn._createTransaction(en,Vt,Jt);r.create(n),r._completion.catch(e);var i=r._reject.bind(r);ct(function(){an.trans=r,0===t?(Ot(Jt).forEach(function(t){D(n,t,Jt[t].primKey,Jt[t].indexes)}),q.follow(function(){return rn.on.populate.fire(r)}).catch(i)):T(t,r,n).catch(i)})}function T(t,n,e){function r(){return i.length?q.resolve(i.shift()(n.idbtrans)).then(r):q.resolve()}var i=[],o=Ht.filter(function(n){return n._cfg.version===t})[0];if(!o)throw new Gt.Upgrade("Dexie specification of currently installed DB version is missing");Jt=rn._dbSchema=o._cfg.dbschema;var u=!1,s=Ht.filter(function(n){return n._cfg.version>t});return s.forEach(function(t){i.push(function(){var r=Jt,i=t._cfg.dbschema;Dt(r,e),Dt(i,e),Jt=rn._dbSchema=i;var o=j(r,i);if(o.add.forEach(function(t){D(e,t[0],t[1].primKey,t[1].indexes)}),o.change.forEach(function(t){if(t.recreate)throw new Gt.Upgrade("Not yet support for changing primary key");var n=e.objectStore(t.name);t.add.forEach(function(t){U(n,t)}),t.change.forEach(function(t){n.deleteIndex(t.name),U(n,t)}),t.del.forEach(function(t){n.deleteIndex(t)})}),t._cfg.contentUpgrade)return u=!0,q.follow(function(){t._cfg.contentUpgrade(n)})}),i.push(function(n){if(!u||!xn){var e=t._cfg.dbschema;M(e,n)}})}),r().then(function(){C(Jt,e)})}function j(t,n){var e={del:[],add:[],change:[]};for(var r in t)n[r]||e.del.push(r);for(r in n){var i=t[r],o=n[r];if(i){var u={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(i.primKey.src!==o.primKey.src)u.recreate=!0,e.change.push(u);else{var s=i.idxByName,c=o.idxByName;for(var a in s)c[a]||u.del.push(a);for(a in c){var f=s[a],h=c[a];f?f.src!==h.src&&u.change.push(h):u.add.push(h)}(u.del.length>0||u.add.length>0||u.change.length>0)&&e.change.push(u)}}else e.add.push([r,o])}return e}function D(t,n,e,r){var i=t.db.createObjectStore(n,e.keyPath?{keyPath:e.keyPath,autoIncrement:e.auto}:{autoIncrement:e.auto});return r.forEach(function(t){U(i,t)}),i}function C(t,n){Ot(t).forEach(function(e){n.db.objectStoreNames.contains(e)||D(n,e,t[e].primKey,t[e].indexes)})}function M(t,n){for(var e=0;e<n.db.objectStoreNames.length;++e){var r=n.db.objectStoreNames[e];null==t[r]&&n.db.deleteObjectStore(r)}}function U(t,n){t.createIndex(n.name,n.keyPath,{unique:n.unique,multiEntry:n.multi})}function F(t){return rn.on.error.fire(t)}function z(t,n,e){if(tn||an.letThrough){var r=rn._createTransaction(t,n,Jt);return r._promise(t,function(t,n){ct(function(){an.trans=r,e(t,n,r)})}).then(function(t){return r._completion.then(function(){return t})})}if(!Xt){if(!qt)return ht(new Gt.DatabaseClosed,F);rn.open().catch(k)}return on.then(function(){return z(t,n,e)})}function W(t,n,e){this.name=t,this.schema=n,this.hook=$t[t]?$t[t].hook:Y(null,{creating:[S,k],reading:[O,A],updating:[I,k],deleting:[P,k]}),this._collClass=e||Z}function G(t,n,e){W.call(this,t,n,e||X)}function J(t,n,e){return(e?mt:gt)(function(e){t.push(e),n&&n()})}function H(t,n,e,r,i){return new q(function(o,u){var s=e.length,c=s-1;if(0===s)return o();if(r){var a,f=mt(u),h=yt(null);v(function(){for(var r=0;r<s;++r){a={onsuccess:null,onerror:null};var u=e[r];i.call(a,u[0],u[1],n);var l=t.delete(u[0]);l._hookCtx=a,l.onerror=f,r===c?l.onsuccess=yt(o):l.onsuccess=h}},function(t){throw a.onerror&&a.onerror(t),t})}else for(var l=0;l<s;++l){var p=t.delete(e[l]);p.onerror=st(gt(u)),l===c&&(p.onsuccess=st(function(){return o()}))}}).uncaught(F)}function V(t,n,e,r){var i=this;this.db=rn,this.mode=t,this.storeNames=n,this.idbtrans=null,this.on=Y(this,"complete","error","abort"),this.parent=r||null,this.active=!0,this._tables=null,this._reculock=0,this._blockedFuncs=[],this._psd=null,this._dbschema=e,this._resolve=null,this._reject=null,this._completion=new q(function(t,n){i._resolve=t,i._reject=n}).uncaught(F),this._completion.then(function(){i.on.complete.fire()},function(t){return i.on.error.fire(t),i.parent?i.parent._reject(t):i.active&&i.idbtrans&&i.idbtrans.abort(),i.active=!1,ht(t)})}function $(t,n,e){this._ctx={table:t,index:":id"===n?null:n,collClass:t._collClass,or:e}}function Z(t,n){var e=null,r=null;if(n)try{e=n()}catch(t){r=t}var i=t._ctx,o=i.table;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:e,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:o.hook.reading.fire}}function Q(t,n){return!(t.filter||t.algorithm||t.or)&&(n?t.justLimit:!t.replayFilter)}function X(){Z.apply(this,arguments)}function tt(t,n){return t._cfg.version-n._cfg.version}function nt(t,n,e,r){n.forEach(function(n){var i=rn._tableFactory(e,r[n]);t.forEach(function(t){n in t||(t[n]=i)})})}function et(t){t.forEach(function(t){for(var n in t)t[n]instanceof W&&delete t[n]})}function rt(t,n,e,r,i,o){var u=o?function(t,n,r){return e(o(t),n,r)}:e,s=st(u,i);t.onerror||(t.onerror=gt(i)),n?t.onsuccess=d(function(){var e=t.result;if(e){var o=function(){e.continue()};n(e,function(t){o=t},r,i)&&s(e.value,e,function(t){o=t}),o()}else r()},i):t.onsuccess=d(function(){var n=t.result;if(n){var e=function(){n.continue()};s(n.value,n,function(t){e=t}),e()}else r()},i)}function it(t){var n=[];return t.split(",").forEach(function(t){t=t.trim();var e=t.replace(/([&*]|\+\+)/g,""),r=/^\[/.test(e)?e.match(/^\[(.*)\]$/)[1].split("+"):e;n.push(new xt(e,r||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),Tt(r),/\./.test(t)))}),n}function ot(t,n){return zt.cmp(t,n)}function ut(t,n){return ot(t,n)<0?t:n}function ft(t,n){return ot(t,n)>0?t:n}function pt(t,n){return zt.cmp(t,n)}function St(t,n){return zt.cmp(n,t)}function Pt(t,n){return t<n?-1:t===n?0:1}function It(t,n){return t>n?-1:t===n?0:1}function jt(t,n){return t?n?function(){return t.apply(this,arguments)&&n.apply(this,arguments)}:t:n}function Rt(){if(rn.verno=Zt.version/10,rn._dbSchema=Jt={},Vt=c(Zt.objectStoreNames,0),0!==Vt.length){var t=Zt.transaction(kt(Vt),"readonly");Vt.forEach(function(n){for(var e=t.objectStore(n),r=e.keyPath,i=r&&"string"==typeof r&&r.indexOf(".")!==-1,o=new xt(r,r||"",!1,!1,!!e.autoIncrement,r&&"string"!=typeof r,i),u=[],s=0;s<e.indexNames.length;++s){var c=e.index(e.indexNames[s]);r=c.keyPath,i=r&&"string"==typeof r&&r.indexOf(".")!==-1;var a=new xt(c.name,r,!!c.unique,!!c.multiEntry,!1,r&&"string"!=typeof r,i);u.push(a)}Jt[n]=new Et(n,o,u,{})}),nt([$t,V.prototype],Ot(Jt),en,Jt)}}function Dt(t,n){for(var e=n.db.objectStoreNames,r=0;r<e.length;++r){var i=e[r],o=n.objectStore(i);Nt="getAll"in o;for(var u=0;u<o.indexNames.length;++u){var s=o.indexNames[u],a=o.index(s).keyPath,f="string"==typeof a?a:"["+c(a).join("+")+"]";if(t[i]){var h=t[i].idxByName[f];h&&(h.name=s)}}}}function Bt(t){rn.on("blocked").fire(t),wn.filter(function(t){return t.name===rn.name&&t!==rn&&!t._vcFired}).map(function(n){return n.on("versionchange").fire(t)})}var Lt,Ut,Nt,Kt=lt.dependencies,Ft=t({addons:lt.addons,autoOpen:!0,indexedDB:Kt.indexedDB,IDBKeyRange:Kt.IDBKeyRange},e),Yt=Ft.addons,qt=Ft.autoOpen,zt=Ft.indexedDB,Wt=Ft.IDBKeyRange,Jt=this._dbSchema={},Ht=[],Vt=[],$t={},Zt=null,Qt=null,Xt=!1,tn=!1,nn="readonly",en="readwrite",rn=this,on=new q(function(t){Lt=t}),un=new q(function(t,n){Ut=n}),sn=!0,cn=!!At(zt);this.version=function(t){if(Zt||Xt)throw new Gt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=Ht.filter(function(n){return n._cfg.version===t})[0];return n?n:(n=new l(t),Ht.push(n),Ht.sort(tt),n)},t(l.prototype,{stores:function(n){this._cfg.storesSource=this._cfg.storesSource?t(this._cfg.storesSource,n):n;var e={};Ht.forEach(function(n){t(e,n._cfg.storesSource)});var r=this._cfg.dbschema={};return this._parseStoresSpec(e,r),Jt=rn._dbSchema=r,et([$t,rn,V.prototype]),nt([$t,rn,V.prototype,this._cfg.tables],Ot(r),en,r),Vt=Ot(r),this},upgrade:function(t){var n=this;return An(function(){t(rn._createTransaction(en,Ot(n._cfg.dbschema),n._cfg.dbschema))}),this._cfg.contentUpgrade=t,this},_parseStoresSpec:function(t,n){Ot(t).forEach(function(e){if(null!==t[e]){var r={},i=it(t[e]),o=i.shift();if(o.multi)throw new Gt.Schema("Primary key cannot be multi-valued");o.keyPath&&g(r,o.keyPath,o.auto?0:o.keyPath),i.forEach(function(t){if(t.auto)throw new Gt.Schema("Only primary key can be marked as autoIncrement (++)");if(!t.keyPath)throw new Gt.Schema("Index must have a name and cannot be an empty string");g(r,t.keyPath,t.compound?t.keyPath.map(function(){return""}):"")}),n[e]=new Et(e,o,i,r)}})}}),this._allTables=$t,this._tableFactory=function(t,n){return t===nn?new W(n.name,n,Z):new G(n.name,n)},this._createTransaction=function(t,n,e,r){return new V(t,n,e,r)},this._whenReady=function(t){return new q(On||tn||an.letThrough?t:function(n,e){if(!Xt){if(!qt)return void e(new Gt.DatabaseClosed);rn.open().catch(k)}on.then(function(){t(n,e)})}).uncaught(F)},this.verno=0,this.open=function(){if(Xt||Zt)return on.then(function(){return Qt?ht(Qt,F):rn});Mt&&(un._stackHolder=B()),Xt=!0,Qt=null,tn=!1;var t=Lt,e=null;return q.race([un,new q(function(t,r){if(f(function(){return t()}),Ht.length>0&&(sn=!1),!zt)throw new Gt.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var i=sn?zt.open(n):zt.open(n,Math.round(10*rn.verno));if(!i)throw new Gt.MissingAPI("IndexedDB API not available");i.onerror=st(gt(r)),i.onblocked=st(Bt),i.onupgradeneeded=st(function(t){if(e=i.transaction,sn&&!rn._allowEmptyDB){i.onerror=bt,e.abort(),i.result.close();var o=zt.deleteDatabase(n);o.onsuccess=o.onerror=st(function(){r(new Gt.NoSuchDatabase("Database "+n+" doesnt exist"))})}else{e.onerror=st(gt(r));var u=t.oldVersion>Math.pow(2,62)?0:t.oldVersion;m(u/10,e,r,i)}},r),i.onsuccess=st(function(){if(e=null,Zt=i.result,wn.push(rn),sn)Rt();else if(Zt.objectStoreNames.length>0)try{Dt(Jt,Zt.transaction(kt(Zt.objectStoreNames),nn))}catch(t){}Zt.onversionchange=st(function(t){rn._vcFired=!0,rn.on("versionchange").fire(t)}),cn||wt(function(t){if(t.indexOf(n)===-1)return t.push(n)}),t()},r)})]).then(function(){return lt.vip(rn.on.ready.fire)}).then(function(){return Xt=!1,rn}).catch(function(t){try{e&&e.abort()}catch(t){}return Xt=!1,rn.close(),Qt=t,ht(Qt,F)}).finally(function(){tn=!0,t()})},this.close=function(){var t=wn.indexOf(rn);if(t>=0&&wn.splice(t,1),Zt){try{Zt.close()}catch(t){}Zt=null}qt=!1,Qt=new Gt.DatabaseClosed,Xt&&Ut(Qt),on=new q(function(t){Lt=t}),un=new q(function(t,n){Ut=n})},this.delete=function(){var t=arguments.length>0;return new q(function(e,r){function i(){rn.close();var t=zt.deleteDatabase(n);t.onsuccess=st(function(){cn||wt(function(t){var e=t.indexOf(n);if(e>=0)return t.splice(e,1)}),e()}),t.onerror=st(gt(r)),t.onblocked=Bt}if(t)throw new Gt.InvalidArgument("Arguments not allowed in db.delete()");Xt?on.then(i):i()}).uncaught(F)},this.backendDB=function(){return Zt},this.isOpen=function(){return null!==Zt},this.hasFailed=function(){return null!==Qt},this.dynamicallyOpened=function(){return sn},this.name=n,o(this,"tables",{get:function(){return Ot($t).map(function(t){return $t[t]})}}),this.on=Y(this,"error","populate","blocked","versionchange",{ready:[R,k]}),this.on.error.subscribe=L("Dexie.on.error",this.on.error.subscribe),this.on.error.unsubscribe=L("Dexie.on.error.unsubscribe",this.on.error.unsubscribe),this.on.ready.subscribe=a(this.on.ready.subscribe,function(t){return function(n,e){lt.vip(function(){tn?(Qt||q.resolve().then(n),e&&t(n)):(t(n),e||t(function t(){rn.on.ready.unsubscribe(n),rn.on.ready.unsubscribe(t)}))})}}),An(function(){rn.on("populate").fire(rn._createTransaction(en,Vt,Jt)),rn.on("error").fire(new Error)}),this.transaction=function(t,n,e){function i(n){var i=an;n(q.resolve().then(function(){return ct(function(){an.transless=an.transless||i;var n=rn._createTransaction(t,f,Jt,c);an.trans=n,c?n.idbtrans=c.idbtrans:n.create();var o=f.map(function(t){return $t[t]});o.push(n);var u;return q.follow(function(){if(u=e.apply(n,o))if("function"==typeof u.next&&"function"==typeof u.throw)u=_t(u);else if("function"==typeof u.then&&!r(u,"_PSD"))throw new Gt.IncompatiblePromise("Incompatible Promise returned from transaction scope (read more at http://tinyurl.com/znyqjqc). Transaction scope: "+e.toString())}).uncaught(F).then(function(){return c&&n._resolve(),n._completion}).then(function(){return u}).catch(function(t){return n._reject(t),ht(t)})})}))}var o=arguments.length;if(o<2)throw new Gt.InvalidArgument("Too few arguments");for(var u=new Array(o-1);--o;)u[o-1]=arguments[o];e=u.pop();var s=E(u),c=an.trans;c&&c.db===rn&&t.indexOf("!")===-1||(c=null);var a=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");try{var f=s.map(function(t){var n=t instanceof W?t.name:t;if("string"!=typeof n)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return n});if("r"==t||t==nn)t=nn;else{if("rw"!=t&&t!=en)throw new Gt.InvalidArgument("Invalid transaction mode: "+t);t=en}if(c){if(c.mode===nn&&t===en){if(!a)throw new Gt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");c=null}c&&f.forEach(function(t){if(c&&c.storeNames.indexOf(t)===-1){if(!a)throw new Gt.SubTransaction("Table "+t+" not included in parent transaction.");c=null}})}}catch(t){return c?c._promise(null,function(n,e){e(t)}):ht(t,F)}return c?c._promise(t,i,"lock"):rn._whenReady(i)},this.table=function(t){if(On&&sn)return new G(t);if(!r($t,t))throw new Gt.InvalidTable("Table "+t+" does not exist");return $t[t]},i(W.prototype,{_trans:function(t,n,e){var r=an.trans;return r&&r.db===rn?r._promise(t,n,e):z(t,[this.name],n)},_idbstore:function(t,n,e){function r(t,e,r){n(t,e,r.idbtrans.objectStore(o),r)}if(On)return new q(n);var i=an.trans,o=this.name;return i&&i.db===rn?i._promise(t,r,e):z(t,[this.name],r)},get:function(t,n){var e=this;return this._idbstore(nn,function(n,r,i){On&&n(e.schema.instanceTemplate);var o=i.get(t);o.onerror=gt(r),o.onsuccess=st(function(){n(e.hook.reading.fire(o.result))},r)}).then(n)},where:function(t){return new $(this,t)},count:function(t){return this.toCollection().count(t)},offset:function(t){return this.toCollection().offset(t)},limit:function(t){return this.toCollection().limit(t)},reverse:function(){return this.toCollection().reverse()},filter:function(t){return this.toCollection().and(t)},each:function(t){return this.toCollection().each(t)},toArray:function(t){return this.toCollection().toArray(t)},orderBy:function(t){return new this._collClass(new $(this,t))},toCollection:function(){return new this._collClass(new $(this))},mapToClass:function(t,n){this.schema.mappedClass=t;var e=Object.create(t.prototype);n&&dt(e,n),this.schema.instanceTemplate=e;var i=function(n){if(!n)return n;var e=Object.create(t.prototype);for(var i in n)if(r(n,i))try{e[i]=n[i]}catch(t){}return e};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=i,this.hook("reading",i),t},defineClass:function(t){return this.mapToClass(lt.defineClass(t),t)}}),u(G).from(W).extend({bulkDelete:function(t){return this.hook.deleting.fire===k?this._idbstore(en,function(n,e,r,i){n(H(r,i,t,!1,k))}):this.where(":id").anyOf(t).delete().then(function(){})},bulkPut:function(t,n){var e=this;return this._idbstore(en,function(r,i,o){if(!o.keyPath&&!e.schema.primKey.auto&&!n)throw new Gt.InvalidArgument("bulkPut() with non-inbound keys requires keys array in second argument");if(o.keyPath&&n)throw new Gt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(n&&n.length!==t.length)throw new Gt.InvalidArgument("Arguments objects and keys must have the same length");if(0===t.length)return r();var u,s,c=function(t){0===a.length?r(t):i(new K(e.name+".bulkPut(): "+a.length+" of "+f+" operations failed",a))},a=[],f=t.length,h=e;if(e.hook.creating.fire===k&&e.hook.updating.fire===k){s=J(a);for(var l=0,d=t.length;l<d;++l)u=n?o.put(t[l],n[l]):o.put(t[l]),u.onerror=s;u.onerror=J(a,c),u.onsuccess=vt(c)}else{var v=n||o.keyPath&&t.map(function(t){return y(t,o.keyPath)}),g=v&&p(v,function(n,e){return null!=n&&[n,t[e]]}),m=v?h.where(":id").anyOf(v.filter(function(t){return null!=t})).modify(function(){this.value=g[this.primKey],g[this.primKey]=null}).catch(N,function(t){a=t.failures}).then(function(){for(var e=[],r=n&&[],i=v.length-1;i>=0;--i){var o=v[i];(null==o||g[o])&&(e.push(t[i]),n&&r.push(o),null!=o&&(g[o]=null))}return e.reverse(),n&&r.reverse(),h.bulkAdd(e,r)}).then(function(t){var n=v[v.length-1];return null!=n?n:t}):h.bulkAdd(t);m.then(c).catch(K,function(t){a=a.concat(t.failures),c()}).catch(i)}},"locked")},bulkAdd:function(t,n){var e=this,r=this.hook.creating.fire;return this._idbstore(en,function(i,o,u,s){function c(t){0===l.length?i(t):o(new K(e.name+".bulkAdd(): "+l.length+" of "+p+" operations failed",l))}if(!u.keyPath&&!e.schema.primKey.auto&&!n)throw new Gt.InvalidArgument("bulkAdd() with non-inbound keys requires keys array in second argument");if(u.keyPath&&n)throw new Gt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(n&&n.length!==t.length)throw new Gt.InvalidArgument("Arguments objects and keys must have the same length");if(0===t.length)return i();var a,f,h,l=[],p=t.length;if(r!==k){var d,m=u.keyPath;f=J(l,null,!0),h=yt(null),v(function(){for(var e=0,i=t.length;e<i;++e){d={onerror:null,onsuccess:null};var o=n&&n[e],c=t[e],l=n?o:m?y(c,m):void 0,p=r.call(d,l,c,s);null==l&&null!=p&&(m?(c=w(c),g(c,m,p)):o=p),a=null!=o?u.add(c,o):u.add(c),a._hookCtx=d,e<i-1&&(a.onerror=f,d.onsuccess&&(a.onsuccess=h))}},function(t){throw d.onerror&&d.onerror(t),t}),a.onerror=J(l,c,!0),a.onsuccess=yt(c)}else{f=J(l);for(var b=0,_=t.length;b<_;++b)a=n?u.add(t[b],n[b]):u.add(t[b]),a.onerror=f;a.onerror=J(l,c),a.onsuccess=vt(c)}})},add:function(t,n){var e=this.hook.creating.fire;return this._idbstore(en,function(r,i,o,u){var s={onsuccess:null,onerror:null};if(e!==k){var c=null!=n?n:o.keyPath?y(t,o.keyPath):void 0,a=e.call(s,c,t,u);null==c&&null!=a&&(o.keyPath?g(t,o.keyPath,a):n=a)}try{var f=null!=n?o.add(t,n):o.add(t);f._hookCtx=s,f.onerror=mt(i),f.onsuccess=yt(function(n){var e=o.keyPath;e&&g(t,e,n),r(n)})}catch(t){throw s.onerror&&s.onerror(t),t}})},put:function(t,n){var e=this,r=this.hook.creating.fire,i=this.hook.updating.fire;return r!==k||i!==k?this._trans(en,function(r,i,o){var u=void 0!==n?n:e.schema.primKey.keyPath&&y(t,e.schema.primKey.keyPath);null==u?e.add(t).then(r,i):(o._lock(),t=w(t),e.where(":id").equals(u).modify(function(){this.value=t}).then(function(r){return 0===r?e.add(t,n):u}).finally(function(){o._unlock()}).then(r,i))}):this._idbstore(en,function(e,r,i){var o=void 0!==n?i.put(t,n):i.put(t);o.onerror=gt(r),o.onsuccess=function(n){var r=i.keyPath;r&&g(t,r,n.target.result),e(o.result)}})},delete:function(t){return this.hook.deleting.subscribers.length?this.where(":id").equals(t).delete():this._idbstore(en,function(n,e,r){var i=r.delete(t);i.onerror=gt(e),i.onsuccess=function(){n(i.result)}})},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection().delete():this._idbstore(en,function(t,n,e){var r=e.clear();r.onerror=gt(n),r.onsuccess=function(){t(r.result)}})},update:function(t,n){if("object"!=typeof n||Tt(n))throw new Gt.InvalidArgument("Modifications must be an object.");if("object"!=typeof t||Tt(t))return this.where(":id").equals(t).modify(n);Ot(n).forEach(function(e){g(t,e,n[e])});var e=y(t,this.schema.primKey.keyPath);return void 0===e?ht(new Gt.InvalidArgument("Given object does not contain its primary key"),F):this.where(":id").equals(e).modify(n)}}),i(V.prototype,{_lock:function(){return h(!an.global),++this._reculock,1!==this._reculock||an.global||(an.lockOwnerFor=this),this},_unlock:function(){if(h(!an.global),0===--this._reculock)for(an.global||(an.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{at(t[1],t[0])}catch(t){}}return this},_locked:function(){return this._reculock&&an.lockOwnerFor!==this},create:function(t){var n=this;if(h(!this.idbtrans),!t&&!Zt)switch(Qt&&Qt.name){case"DatabaseClosedError":throw new Gt.DatabaseClosed(Qt);case"MissingAPIError":throw new Gt.MissingAPI(Qt.message,Qt);default:throw new Gt.OpenFailed(Qt)}if(!this.active)throw new Gt.TransactionInactive;return h(null===this._completion._state),t=this.idbtrans=t||Zt.transaction(kt(this.storeNames),this.mode),t.onerror=st(function(e){bt(e),n._reject(t.error)}),t.onabort=st(function(t){bt(t),n.active&&n._reject(new Gt.Abort),n.active=!1,n.on("abort").fire(t)}),t.oncomplete=st(function(){n.active=!1,n._resolve()}),this},_promise:function(t,n,e){var r=this,i=r._locked()?new q(function(i,o){r._blockedFuncs.push([function(){r._promise(t,n,e).then(i,o)},an])}):ct(function(){var i=r.active?new q(function(i,o){if(t===en&&r.mode!==en)throw new Gt.ReadOnly("Transaction is readonly");!r.idbtrans&&t&&r.create(),e&&r._lock(),n(i,o,r)}):ht(new Gt.TransactionInactive);return r.active&&e&&i.finally(function(){r._unlock()}),i});return i._lib=!0,i.uncaught(F)},abort:function(){this.active&&this._reject(new Gt.Abort),this.active=!1},tables:{get:L("Transaction.tables",function(){return p(this.storeNames,function(t){return[t,$t[t]]})},"Use db.tables()")},complete:L("Transaction.complete()",function(t){return this.on("complete",t)}),error:L("Transaction.error()",function(t){return this.on("error",t)}),table:L("Transaction.table()",function(t){if(this.storeNames.indexOf(t)===-1)throw new Gt.InvalidTable("Table "+t+" not in transaction");return $t[t]})}),i($.prototype,function(){function t(t,n,e){var r=t instanceof $?new t._ctx.collClass(t):t;return r._ctx.error=e?new e(n):new TypeError(n),r}function n(t){return new t._ctx.collClass(t,function(){return Wt.only("")}).limit(0)}function e(t){return"next"===t?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function r(t){return"next"===t?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function i(t,n,e,r,i,o){for(var u=Math.min(t.length,r.length),s=-1,c=0;c<u;++c){var a=n[c];if(a!==r[c])return i(t[c],e[c])<0?t.substr(0,c)+e[c]+e.substr(c+1):i(t[c],r[c])<0?t.substr(0,c)+r[c]+e.substr(c+1):s>=0?t.substr(0,s)+n[s]+e.substr(s+1):null;i(t[c],a)<0&&(s=c)}return u<r.length&&"next"===o?t+e.substr(t.length):u<t.length&&"prev"===o?t.substr(0,e.length):s<0?null:t.substr(0,s)+r[s]+e.substr(s+1)}function o(n,o,u,s){function c(t){a=e(t),f=r(t),h="next"===t?Pt:It;var n=u.map(function(t){return{lower:f(t),upper:a(t)}}).sort(function(t,n){return h(t.lower,n.lower)});l=n.map(function(t){return t.upper}),p=n.map(function(t){return t.lower}),d=t,v="next"===t?"":s}var a,f,h,l,p,d,v,y=u.length;if(!u.every(function(t){return"string"==typeof t}))return t(n,bn);c("next");var g=new n._ctx.collClass(n,function(){return Wt.bound(l[0],p[y-1]+s)});g._ondirectionchange=function(t){c(t)};var m=0;return g._addAlgorithm(function(t,n,e){var r=t.key;if("string"!=typeof r)return!1;var u=f(r);if(o(u,p,m))return!0;for(var s=null,c=m;c<y;++c){var a=i(r,u,l[c],p[c],h,d);null===a&&null===s?m=c+1:(null===s||h(s,a)>0)&&(s=a)}return n(null!==s?function(){t.continue(s+v)}:e),!1}),g}return{between:function(e,r,i,o){i=i!==!1,o=o===!0;try{return ot(e,r)>0||0===ot(e,r)&&(i||o)&&(!i||!o)?n(this):new this._ctx.collClass(this,function(){return Wt.bound(e,r,!i,!o)})}catch(n){return t(this,mn)}},equals:function(t){return new this._ctx.collClass(this,function(){return Wt.only(t)})},above:function(t){return new this._ctx.collClass(this,function(){return Wt.lowerBound(t,!0)})},aboveOrEqual:function(t){return new this._ctx.collClass(this,function(){return Wt.lowerBound(t)})},below:function(t){return new this._ctx.collClass(this,function(){return Wt.upperBound(t,!0)})},belowOrEqual:function(t){return new this._ctx.collClass(this,function(){return Wt.upperBound(t)})},startsWith:function(n){return"string"!=typeof n?t(this,bn):this.between(n,n+yn,!0,!0)},startsWithIgnoreCase:function(t){return""===t?this.startsWith(t):o(this,function(t,n){return 0===t.indexOf(n[0])},[t],yn)},equalsIgnoreCase:function(t){return o(this,function(t,n){return t===n[0]},[t],"")},anyOfIgnoreCase:function(){var t=x.apply(Ct,arguments);return 0===t.length?n(this):o(this,function(t,n){return n.indexOf(t)!==-1},t,"")},startsWithAnyOfIgnoreCase:function(){var t=x.apply(Ct,arguments);return 0===t.length?n(this):o(this,function(t,n){return n.some(function(n){return 0===t.indexOf(n)})},t,yn)},anyOf:function(){var e=x.apply(Ct,arguments),r=pt;try{e.sort(r)}catch(n){return t(this,mn)}if(0===e.length)return n(this);var i=new this._ctx.collClass(this,function(){return Wt.bound(e[0],e[e.length-1])});i._ondirectionchange=function(t){r="next"===t?pt:St,e.sort(r)};var o=0;return i._addAlgorithm(function(t,n,i){for(var u=t.key;r(u,e[o])>0;)if(++o,o===e.length)return n(i),!1;return 0===r(u,e[o])||(n(function(){t.continue(e[o])}),!1)}),i},notEqual:function(t){return this.inAnyRange([[-(1/0),t],[t,gn]],{includeLowers:!1,includeUppers:!1})},noneOf:function(){var n=x.apply(Ct,arguments);if(0===n.length)return new this._ctx.collClass(this);try{n.sort(pt)}catch(n){return t(this,mn)}var e=n.reduce(function(t,n){return t?t.concat([[t[t.length-1][1],n]]):[[-(1/0),n]]},null);return e.push([n[n.length-1],gn]),this.inAnyRange(e,{includeLowers:!1,includeUppers:!1})},inAnyRange:function(e,r){function i(t,n){for(var e=0,r=t.length;e<r;++e){var i=t[e];if(ot(n[0],i[1])<0&&ot(n[1],i[0])>0){i[0]=ut(i[0],n[0]),i[1]=ft(i[1],n[1]);break}}return e===r&&t.push(n),t}function o(t,n){return h(t[0],n[0])}function u(t){return!p(t)&&!d(t)}var s=this._ctx;if(0===e.length)return n(this);
if(!e.every(function(t){return void 0!==t[0]&&void 0!==t[1]&&pt(t[0],t[1])<=0}))return t(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Gt.InvalidArgument);var c,a=!r||r.includeLowers!==!1,f=r&&r.includeUppers===!0,h=pt;try{c=e.reduce(i,[]),c.sort(o)}catch(n){return t(this,mn)}var l=0,p=f?function(t){return pt(t,c[l][1])>0}:function(t){return pt(t,c[l][1])>=0},d=a?function(t){return St(t,c[l][0])>0}:function(t){return St(t,c[l][0])>=0},v=p,y=new s.collClass(this,function(){return Wt.bound(c[0][0],c[c.length-1][1],!a,!f)});return y._ondirectionchange=function(t){"next"===t?(v=p,h=pt):(v=d,h=St),c.sort(o)},y._addAlgorithm(function(t,n,e){for(var r=t.key;v(r);)if(++l,l===c.length)return n(e),!1;return!!u(r)||0!==ot(r,c[l][1])&&0!==ot(r,c[l][0])&&(n(function(){h===pt?t.continue(c[l][0]):t.continue(c[l][1])}),!1)}),y},startsWithAnyOf:function(){var e=x.apply(Ct,arguments);return e.every(function(t){return"string"==typeof t})?0===e.length?n(this):this.inAnyRange(e.map(function(t){return[t,t+yn]})):t(this,"startsWithAnyOf() only works with strings")}}}),i(Z.prototype,function(){function n(t,n){t.filter=jt(t.filter,n)}function e(t,n,e){var r=t.replayFilter;t.replayFilter=r?function(){return jt(r(),n())}:n,t.justLimit=e&&!r}function i(t,n){t.isMatch=jt(t.isMatch,n)}function o(t,n){if(t.isPrimKey)return n;var e=t.table.schema.idxByName[t.index];if(!e)throw new Gt.Schema("KeyPath "+t.index+" on object store "+n.name+" is not indexed");return n.index(e.name)}function u(t,n){var e=o(t,n);return t.keysOnly&&"openKeyCursor"in e?e.openKeyCursor(t.range||null,t.dir+t.unique):e.openCursor(t.range||null,t.dir+t.unique)}function s(t,n,e,i,o){var s=t.replayFilter?jt(t.filter,t.replayFilter()):t.filter;t.or?function(){function c(){2===++h&&e()}function a(t,e,o){if(!s||s(e,o,c,i)){var u=e.primaryKey.toString();r(f,u)||(f[u]=!0,n(t,e,o))}}var f={},h=0;t.or._iterate(a,c,i,o),rt(u(t,o),t.algorithm,a,c,i,!t.keysOnly&&t.valueMapper)}():rt(u(t,o),jt(t.algorithm,s),n,e,i,!t.keysOnly&&t.valueMapper)}function c(t){return t.table.schema.instanceTemplate}return{_read:function(t,n){var e=this._ctx;return e.error?e.table._trans(null,function(t,n){n(e.error)}):e.table._idbstore(nn,t).then(n)},_write:function(t){var n=this._ctx;return n.error?n.table._trans(null,function(t,e){e(n.error)}):n.table._idbstore(en,t,"locked")},_addAlgorithm:function(t){var n=this._ctx;n.algorithm=jt(n.algorithm,t)},_iterate:function(t,n,e,r){return s(this._ctx,t,n,e,r)},clone:function(n){var e=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return n&&t(r,n),e._ctx=r,e},raw:function(){return this._ctx.valueMapper=null,this},each:function(t){var n=this._ctx;if(On){var e=c(n),r=n.table.schema.primKey.keyPath,i=y(e,n.index?n.table.schema.idxByName[n.index].keyPath:r),o=y(e,r);t(e,{key:i,primaryKey:o})}return this._read(function(e,r,i){s(n,t,e,r,i)})},count:function(t){if(On)return q.resolve(0).then(t);var n=this._ctx;if(Q(n,!0))return this._read(function(t,e,r){var i=o(n,r),u=n.range?i.count(n.range):i.count();u.onerror=gt(e),u.onsuccess=function(e){t(Math.min(e.target.result,n.limit))}},t);var e=0;return this._read(function(t,r,i){s(n,function(){return++e,!1},function(){t(e)},r,i)},t)},sortBy:function(t,n){function e(t,n){return n?e(t[i[n]],n-1):t[o]}function r(t,n){var r=e(t,u),i=e(n,u);return r<i?-s:r>i?s:0}var i=t.split(".").reverse(),o=i[0],u=i.length-1,s="next"===this._ctx.dir?1:-1;return this.toArray(function(t){return t.sort(r)}).then(n)},toArray:function(t){var n=this._ctx;return this._read(function(t,e,r){if(On&&t([c(n)]),Nt&&"next"===n.dir&&Q(n,!0)&&n.limit>0){var i=n.table.hook.reading.fire,u=o(n,r),a=n.limit<1/0?u.getAll(n.range,n.limit):u.getAll(n.range);a.onerror=gt(e),a.onsuccess=i===A?vt(t):st(vt(function(n){try{t(n.map(i))}catch(t){e(t)}}))}else{var f=[];s(n,function(t){f.push(t)},function(){t(f)},e,r)}},t)},offset:function(t){var n=this._ctx;return t<=0?this:(n.offset+=t,Q(n)?e(n,function(){var n=t;return function(t,e){return 0===n||(1===n?(--n,!1):(e(function(){t.advance(n),n=0}),!1))}}):e(n,function(){var n=t;return function(){return--n<0}}),this)},limit:function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),e(this._ctx,function(){var n=t;return function(t,e,r){return--n<=0&&e(r),n>=0}},!0),this},until:function(t,e){var r=this._ctx;return On&&t(c(r)),n(this._ctx,function(n,r,i){return!t(n.value)||(r(i),e)}),this},first:function(t){return this.limit(1).toArray(function(t){return t[0]}).then(t)},last:function(t){return this.reverse().first(t)},filter:function(t){return On&&t(c(this._ctx)),n(this._ctx,function(n){return t(n.value)}),i(this._ctx,t),this},and:function(t){return this.filter(t)},or:function(t){return new $(this._ctx.table,t,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(n,e){t(e.key,e)})},eachUniqueKey:function(t){return this._ctx.unique="unique",this.eachKey(t)},eachPrimaryKey:function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(n,e){t(e.primaryKey,e)})},keys:function(t){var n=this._ctx;n.keysOnly=!n.isMatch;var e=[];return this.each(function(t,n){e.push(n.key)}).then(function(){return e}).then(t)},primaryKeys:function(t){var n=this._ctx;if(Nt&&"next"===n.dir&&Q(n,!0)&&n.limit>0)return this._read(function(t,e,r){var i=o(n,r),u=n.limit<1/0?i.getAllKeys(n.range,n.limit):i.getAllKeys(n.range);u.onerror=gt(e),u.onsuccess=vt(t)}).then(t);n.keysOnly=!n.isMatch;var e=[];return this.each(function(t,n){e.push(n.primaryKey)}).then(function(){return e}).then(t)},uniqueKeys:function(t){return this._ctx.unique="unique",this.keys(t)},firstKey:function(t){return this.limit(1).keys(function(t){return t[0]}).then(t)},lastKey:function(t){return this.reverse().firstKey(t)},distinct:function(){var t=this._ctx,e=t.index&&t.table.schema.idxByName[t.index];if(!e||!e.multi)return this;var i={};return n(this._ctx,function(t){var n=t.primaryKey.toString(),e=r(i,n);return i[n]=!0,!e}),this}}}),u(X).from(Z).extend({modify:function(n){var e=this,i=this._ctx,o=i.table.hook,u=o.updating.fire,s=o.deleting.fire;return On&&"function"==typeof n&&n.call({value:i.table.schema.instanceTemplate},i.table.schema.instanceTemplate),this._write(function(i,o,c,a){function f(t,n){function e(t){return T.push(t),S.push(i.primKey),l(),!0}P=n.primaryKey;var i={primKey:n.primaryKey,value:t,onsuccess:null,onerror:null};if(p.call(i,t,i)!==!1){var o=!r(i,"value");++E,v(function(){var t=o?n.delete():n.update(i.value);t._hookCtx=i,t.onerror=mt(e),t.onsuccess=yt(function(){++A,l()})},e)}else i.onsuccess&&i.onsuccess(i.value)}function h(t){return t&&(T.push(t),S.push(P)),o(new N("Error modifying one or more objects",T,A,S))}function l(){O&&A+T.length===E&&(T.length>0?h():i(A))}var p;if("function"==typeof n)p=u===k&&s===k?n:function(t){var e=w(t);if(n.call(this,t,this)===!1)return!1;if(r(this,"value")){var i=_(e,this.value),o=u.call(this,i,this.primKey,e,a);o&&(t=this.value,Ot(o).forEach(function(n){g(t,n,o[n])}))}else s.call(this,this.primKey,t,a)};else if(u===k){var d=Ot(n),m=d.length;p=function(t){for(var e=!1,r=0;r<m;++r){var i=d[r],o=n[i];y(t,i)!==o&&(g(t,i,o),e=!0)}return e}}else{var x=n;n=b(x),p=function(e){var r=!1,i=u.call(this,n,this.primKey,w(e),a);return i&&t(n,i),Ot(n).forEach(function(t){var i=n[t];y(e,t)!==i&&(g(e,t,i),r=!0)}),i&&(n=b(x)),r}}var E=0,A=0,O=!1,T=[],S=[],P=null;e.clone().raw()._iterate(f,function(){O=!0,l()},h,c)})},delete:function(){var t=this,n=this._ctx,e=n.range,r=n.table.hook.deleting.fire,i=r!==k;if(!i&&Q(n)&&(n.isPrimKey&&!En||!e))return this._write(function(t,n,r){var i=gt(n),o=e?r.count(e):r.count();o.onerror=i,o.onsuccess=function(){var u=o.result;v(function(){var n=e?r.delete(e):r.clear();n.onerror=i,n.onsuccess=function(){return t(u)}},function(t){return n(t)})}});var o=i?2e3:1e4;return this._write(function(e,u,s,c){var a=0,f=t.clone({keysOnly:!n.isMatch&&!i}).distinct().limit(o).raw(),h=[],l=function(){return f.each(i?function(t,n){h.push([n.primaryKey,n.value])}:function(t,n){h.push(n.primaryKey)}).then(function(){return i?h.sort(function(t,n){return pt(t[0],n[0])}):h.sort(pt),H(s,c,h,i,r)}).then(function(){var t=h.length;return a+=t,h=[],t<o?a:l()})};e(l())})}}),t(this,{Collection:Z,Table:W,Transaction:V,Version:l,WhereClause:$,WriteableCollection:X,WriteableTable:G}),s(),Yt.forEach(function(t){t(rn)})}function pt(t){if("function"==typeof t)return new t;if(Tt(t))return[pt(t[0])];if(t&&"object"==typeof t){var n={};return dt(n,t),n}return t}function dt(t,n){return Ot(n).forEach(function(e){var r=pt(n[e]);t[e]=r}),t}function vt(t){return function(n){t(n.target.result)}}function yt(t){return st(function(n){var e=n.target,r=e.result,i=e._hookCtx,o=i&&i.onsuccess;o&&o(r),t&&t(r)},t)}function gt(t){return function(n){return bt(n),t(n.target.error),!1}}function mt(t){return st(function(n){var e=n.target,r=e.error,i=e._hookCtx,o=i&&i.onerror;return o&&o(r),bt(n),t(r),!1})}function bt(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}function wt(t){var n,e=lt.dependencies.localStorage;if(!e)return t([]);try{n=JSON.parse(e.getItem("Dexie.DatabaseNames")||"[]")}catch(t){n=[]}t(n)&&e.setItem("Dexie.DatabaseNames",JSON.stringify(n))}function _t(t){function n(t){return function(n){var e=t(n),r=e.value;return e.done?r:r&&"function"==typeof r.then?r.then(i,o):Tt(r)?q.all(r).then(i,o):i(r)}}var e=function(n){return t.next(n)},r=function(n){return t.throw(n)},i=n(e),o=n(r);return n(e)()}function xt(t,n,e,r,i,o,u){this.name=t,this.keyPath=n,this.unique=e,this.multi=r,this.auto=i,this.compound=o,this.dotted=u;var s="string"==typeof n?n:n&&"["+[].join.call(n,"+")+"]";this.src=(e?"&":"")+(r?"*":"")+(i?"++":"")+s}function Et(t,n,e,r){this.name=t,this.primKey=n||new xt,this.indexes=e||[new xt],this.instanceTemplate=r,this.mappedClass=null,this.idxByName=p(e,function(t){return[t.name,t]})}function kt(t){return 1===t.length?t[0]:t}function At(t){var n=t&&(t.getDatabaseNames||t.webkitGetDatabaseNames);return n&&n.bind(t)}var Ot=Object.keys,Tt=Array.isArray,St="undefined"!=typeof self?self:"undefined"!=typeof window?window:n,Pt=Object.getPrototypeOf,It={}.hasOwnProperty,jt=Object.getOwnPropertyDescriptor,Rt=[].slice,Dt="undefined"!=typeof Symbol&&Symbol.iterator,Bt=Dt?function(t){var n;return null!=t&&(n=t[Dt])&&n.apply(t)}:function(){return null},Ct={},Lt=[].concat,Mt="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href),Ut=function(){return!0},Nt=!new Error("").stack,Kt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","IncompatiblePromise"],Ft=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Yt=Kt.concat(Ft),qt={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};u(M).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+C(this._e,2))}},toString:function(){return this.name+": "+this.message}}),u(N).from(M),u(K).from(M);var zt=Yt.reduce(function(t,n){return t[n]=n+"Error",t},{}),Wt=M,Gt=Yt.reduce(function(t,n){function e(t,e){this._e=B(),this.name=r,t?"string"==typeof t?(this.message=t,this.inner=e||null):"object"==typeof t&&(this.message=t.name+" "+t.message,this.inner=t):(this.message=qt[n]||r,this.inner=null)}var r=n+"Error";return u(e).from(Wt),t[n]=e,t},{});Gt.Syntax=SyntaxError,Gt.Type=TypeError,Gt.Range=RangeError;var Jt=Ft.reduce(function(t,n){return t[n+"Error"]=Gt[n],t},{}),Ht=Yt.reduce(function(t,n){return["Syntax","Type","Range"].indexOf(n)===-1&&(t[n+"Error"]=Gt[n]),t},{});Ht.ModifyError=N,Ht.DexieError=M,Ht.BulkError=K;var Vt={},$t=100,Zt=20,Qt=!1,Xt=St.setImmediate?e.bind(null,Q):St.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){Q(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(Q,0)},tn=function(t,n){fn.push([t,n]),en&&(Xt(),en=!1)},nn=!0,en=!0,rn=[],on=[],un=null,sn=A,cn={global:!0,ref:0,unhandleds:[],onunhandled:ft,finalize:function(){this.unhandleds.forEach(function(t){try{ft(t[0],t[1])}catch(t){}})}},an=cn,fn=[],hn=0,ln=[];i(q.prototype,{then:function(t,n){var e=this,r=new q(function(r,i){H(e,new z(t,n,r,i))});return Mt&&(!this._prev||null===this._state)&&Z(r,this),r},_then:function(t,n){H(this,new z(null,null,t,n))},catch:function(t){if(1===arguments.length)return this.then(null,t);var n=arguments[0],e=arguments[1];return"function"==typeof n?this.then(null,function(t){return t instanceof n?e(t):ut(t)}):this.then(null,function(t){return t&&t.name===n?e(t):ut(t)})},finally:function(t){return this.then(function(n){return t(),n},function(n){return t(),ut(n)})},uncaught:function(t){var n=this;return this.onuncatched=j(this.onuncatched,t),this._state===!1&&rn.indexOf(this)===-1&&rn.some(function(t,e,r){return t._value===n._value&&(r[e]=n)}),this},stack:{get:function(){if(this._stack)return this._stack;try{Qt=!0;var t=$(this,[],Zt),n=t.join("\nFrom previous: ");return null!==this._state&&(this._stack=n),n}finally{Qt=!1}}}}),i(q,{all:function(){var t=x.apply(null,arguments);return new q(function(n,e){0===t.length&&n([]);var r=t.length;t.forEach(function(i,o){return q.resolve(i).then(function(e){t[o]=e,--r||n(t)},e)})})},resolve:function(t){return t instanceof q?t:t&&"function"==typeof t.then?new q(function(n,e){t.then(n,e)}):new q(Vt,!0,t)},reject:ut,race:function(){var t=x.apply(null,arguments);return new q(function(n,e){t.map(function(t){return q.resolve(t).then(n,e)})})},PSD:{get:function(){return an},set:function(t){return an=t}},newPSD:ct,usePSD:at,scheduler:{get:function(){return tn},set:function(t){tn=t}},rejectionMapper:{get:function(){return sn},set:function(t){sn=t}},follow:function(t){return new q(function(n,e){return ct(function(n,e){var r=an;r.unhandleds=[],r.onunhandled=e,r.finalize=T(function(){var t=this;et(function(){0===t.unhandleds.length?n():e(t.unhandleds[0])})},r.finalize),t()},n,e)})},on:Y(null,{error:[j,ot]})});var pn=q.on.error;pn.subscribe=L("Promise.on('error')",pn.subscribe),pn.unsubscribe=L("Promise.on('error').unsubscribe",pn.unsubscribe);var dn="unhandledrejection";f(function(){tn=function(t,n){setTimeout(function(){t.apply(null,n)},0)}});var vn="1.5.1",yn=String.fromCharCode(65535),gn=function(){try{return IDBKeyRange.only([[]]),[[]]}catch(t){return yn}}(),mn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",bn="String expected.",wn=[],_n="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),xn=_n,En=_n,kn=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)};D(Mt,kn);var An=function(){},On=!1,Tn=St.idbModules&&St.idbModules.shimIndexedDB?St.idbModules:{};return i(lt,Ht),i(lt,{delete:function(t){var n=new lt(t),e=n.delete();return e.onblocked=function(t){return n.on("blocked",t),this},e},exists:function(t){return new lt(t).open().then(function(t){return t.close(),!0}).catch(lt.NoSuchDatabaseError,function(){return!1})},getDatabaseNames:function(t){return new q(function(t,n){var e=At(indexedDB);if(e){var r=e();r.onsuccess=function(n){t(c(n.target.result,0))},r.onerror=gt(n)}else wt(function(n){return t(n),!1})}).then(t)},defineClass:function(n){function e(e){e?t(this,e):On&&dt(this,n)}return e},applyStructure:dt,ignoreTransaction:function(t){return an.trans?at(an.transless,t):t()},vip:function(t){return ct(function(){return an.letThrough=!0,t()})},async:function(t){return function(){try{var n=_t(t.apply(this,arguments));return n&&"function"==typeof n.then?n:q.resolve(n)}catch(t){return ht(t)}}},spawn:function(t,n,e){try{var r=_t(t.apply(e,n||[]));return r&&"function"==typeof r.then?r:q.resolve(r)}catch(t){return ht(t)}},currentTransaction:{get:function(){return an.trans||null}},Promise:q,debug:{get:function(){return Mt},set:function(t){D(t,"dexie"===t?function(){return!0}:kn)}},derive:u,extend:t,props:i,override:a,Events:Y,events:{get:L(function(){return Y})},getByKeyPath:y,setByKeyPath:g,delByKeyPath:m,shallowClone:b,deepClone:w,getObjectDiff:_,asap:l,maxKey:gn,addons:[],connections:wn,MultiModifyError:Gt.Modify,errnames:zt,IndexSpec:xt,TableSchema:Et,dependencies:{indexedDB:Tn.shimIndexedDB||St.indexedDB||St.mozIndexedDB||St.webkitIndexedDB||St.msIndexedDB,IDBKeyRange:Tn.IDBKeyRange||St.IDBKeyRange||St.webkitIDBKeyRange},semVer:vn,version:vn.split(".").map(function(t){return parseInt(t)}).reduce(function(t,n,e){return t+n/Math.pow(10,2*e)}),fakeAutoComplete:An,default:lt}),v(function(){lt.dependencies.localStorage=null!=("undefined"!=typeof chrome&&null!==chrome?chrome.storage:void 0)?null:St.localStorage}),q.rejectionMapper=F,f(function(){lt.fakeAutoComplete=An=f,lt.fake=On=!0}),lt})}).call(n,e(4),e(6).setImmediate)},function(t,n,e){"use strict";(function(n){function r(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function o(t){return t.length-1}function u(t){return t[o(t)]}function s(t){return n.isBuffer(t)?t:n.from(t)}var c=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=e(26),f=e(69),h=e(46),l=e(71),p=e(45),d=e(68).recent,v=e(13);t.exports=function(){function t(n){i(this,t),this.path=n||"pull-blob-store-"+Math.random().toString().slice(2,10),this.db=new a(this.path),this.db.version(1).stores(r({},this.path,"++,key,blob"))}return c(t,[{key:"write",value:function(t,e){var r=this;e=e||function(){};var i=p();return t?(this.remove(t,function(c){function a(n,e){var r=n.map(function(n){return{key:t,blob:n}});l.bulkPut(r).then(function(){return e()}).catch(e)}function h(t,e){return t=t||[],Array.isArray(e)||(e=[e]),e=e.map(s),!t.length||u(t).length>99?t.push(n.concat(e)):t[o(t)]=n.concat(u(t).concat(e)),t}if(c)return e(c);var l=r.table;i.resolve(v(d(100,10),f(a,h,100,e)))}),i):(e(new Error("Missing key")),i)}},{key:"read",value:function(t){var n=this,e=h();return t?(this.exists(t,function(r,i){return r?e.end(r):i?void n.table.where("key").equals(t).each(function(t){return e.push(l(t.blob))}).catch(function(t){return e.end(t)}).then(function(){return e.end()}):e.end(new Error("Not found"))}),e):(e.end(new Error("Missing key")),e)}},{key:"exists",value:function(t,n){return n=n||function(){},t?void this.table.where("key").equals(t).count().then(function(t){return n(null,Boolean(t))}).catch(n):n(new Error("Missing key"))}},{key:"remove",value:function(t,n){if(n=n||function(){},!t)return n(new Error("Missing key"));var e=this.table.where("key").equals(t);e.count(function(t){return t>0?e.delete():null}).then(function(){return n()}).catch(n)}},{key:"table",get:function(){return this.db[this.path]}}]),t}()}).call(n,e(0).Buffer)},function(t,n){n.read=function(t,n,e,r,i){var o,u,s=8*i-r-1,c=(1<<s)-1,a=c>>1,f=-7,h=e?i-1:0,l=e?-1:1,p=t[n+h];for(h+=l,o=p&(1<<-f)-1,p>>=-f,f+=s;f>0;o=256*o+t[n+h],h+=l,f-=8);for(u=o&(1<<-f)-1,o>>=-f,f+=r;f>0;u=256*u+t[n+h],h+=l,f-=8);if(0===o)o=1-a;else{if(o===c)return u?NaN:(p?-1:1)*(1/0);u+=Math.pow(2,r),o-=a}return(p?-1:1)*u*Math.pow(2,o-r)},n.write=function(t,n,e,r,i,o){var u,s,c,a=8*o-i-1,f=(1<<a)-1,h=f>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,v=n<0||0===n&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(s=isNaN(n)?1:0,u=f):(u=Math.floor(Math.log(n)/Math.LN2),n*(c=Math.pow(2,-u))<1&&(u--,c*=2),n+=u+h>=1?l/c:l*Math.pow(2,1-h),n*c>=2&&(u++,c/=2),u+h>=f?(s=0,u=f):u+h>=1?(s=(n*c-1)*Math.pow(2,i),u+=h):(s=n*Math.pow(2,h-1)*Math.pow(2,i),u=0));i>=8;t[e+p]=255&s,p+=d,s/=256,i-=8);for(u=u<<i|s,a+=i;a>0;t[e+p]=255&u,p+=d,u/=256,a-=8);t[e+p-d]|=128*v}},function(t,n,e){"use strict";e(12);class r{static sort(t){var n=[],e={},i=r.findHeads(t).sort((t,n)=>t.id>n.id).sort((t,n)=>t.id==n.id&&t.hash<n.hash),o={};for(t.forEach(t=>o[t.hash]=t);i.length>0;){var u=i.shift();if(!e[u.hash]){e[u.hash]=u;var s=u.next.map(t=>n.findIndex(n=>n.hash===t)),c=Math.max.apply(null,s),a=n.findIndex(t=>t.next.includes(u.hash)),f=n.length;c>-1?f=Math.max(a,c+1):a>-1&&(f=a),n.splice(f,0,u);var h=u.next.map(t=>o[t]).filter(t=>void 0!==t).sort((t,n)=>t.id>n.id);h.forEach((t,n)=>{var e=i.map(t=>t.hash).indexOf(t.hash);e>-1&&i.splice(e,1),i.unshift(t)})}}return n}static findHeads(t){var n=t.slice().reduce((t,n,e)=>{return n.next.forEach(e=>t[e]=n.hash),t},{});return t.filter(t=>void 0===n[t.hash]).sort((t,n)=>t.id>n.id)}}t.exports=r},function(t,n,e){"use strict";(function(n){const r=e(12),i=e(29),o=e(44),u=()=>new Error("Ipfs instance not defined"),s=()=>new Error("Log instance not defined");class c{constructor(t,n,e){this._id=t||(new Date).getTime(),this._entries=n||[],this._heads=e||[]}get id(){return this._id}get items(){return this._entries.slice()}get heads(){return this._heads.slice()}get(t){return this.items.find(n=>n.hash===t)||null}toString(){return this.items.slice().reverse().map((t,n)=>{const e=r.findParents(t,this.items),i=e.length;let o=new Array(Math.max(i-1,0));return o=i>1?o.fill("  "):o,o=i>0?o.concat(["└─"]):o,o.join("")+t.payload}).join("\n")}toJSON(){return{id:this.id,heads:this.heads}}toBuffer(){return new n(JSON.stringify(this.toJSON()))}}class a{static create(t,n,e){if(void 0!==n&&!Array.isArray(n))throw new Error("entries argument must be an array");if(void 0!==e&&!Array.isArray(e))throw new Error("heads argument must be an array");return Array.isArray(n)&&!e&&(e=i.findHeads(n).map(t=>t.hash)),new c(t,n,e)}static append(t,n,e){if(!t)throw u();if(!n)throw s();if(!n.heads||!n.id||!n.items)throw new Error("Not a Log instance");return r.create(t,n.id,e,n.heads).then(t=>{const e=n.items.concat([t]),r=[t.hash];return a.create(n.id,e,r)})}static join(t,n,e,r){if(!t||!n)throw s();if(!t.items||!n.items)throw new Error("Log to join must be an instance of Log");e=e&&e>-1?e:t.items.length+n.items.length,r=r||[t,n].sort((t,n)=>t.id>n.id)[0].id;const o=t.items.concat(n.items),u=i.sort(o),c=a.create(r,u.slice(-e));return c}static joinAll(t,n){return t.reduce((t,e,r)=>{return t?a.join(t,e,n):e},null)}static expand(t,n,e=-1,r){if(!t)throw u();if(!n)throw s();const o=n.items.reduce((t,n)=>t.concat(n.next),[]),c=n.items.map(t=>t.hash),f=o.filter(t=>!c.includes(t)).sort((t,n)=>t>n);return 0===f.length?Promise.resolve(a.create(n.id,n.items,n.heads)):a.fetchAll(t,f,Math.max(e,-1),n.items.map(t=>t.hash)).then(t=>{const e=i.sort(t.concat(n.items)),r=a.create(n.id,e);return r})}static fromEntry(t,n,e=-1,o,s){if(!t)throw u();n&&!Array.isArray(n)&&(n=[n]),n.forEach(t=>{if(!r.isEntry(t))throw new Error("'entries' need to be an array of Entry instances")}),o=o?o.map(t=>t.hash?t.hash:t):o;const c=e-n.length,f=n.map(t=>t.hash),h=n.reduce((t,n)=>{return n.next.forEach(n=>t.push(n)),t},[]);return a.fetchAll(t,h,c,o).then(t=>{const e=t.concat(n),r=i.sort(e),o=e.find(t=>f.includes(t.hash)),u=a.create(o.id,r);return u})}static fromMultihash(t,n,e=-1,r,o){if(!t)throw u();if(!n)throw new Error("Invalid hash: "+n);return t.object.get(n,{enc:"base58"}).then(t=>JSON.parse(t.toJSON().data)).then(n=>{if(!n.heads||!n.id)throw new Error("Not a Log instance");return a.fetchAll(t,n.heads,e,r).then(t=>{const e=i.sort(t),r=a.create(n.id,e,n.heads);return r})})}static toMultihash(t,n){if(!t)throw u();if(!n)throw s();if(!n.items||n.items.length<1)throw new Error(`Can't serialize an empty log`);if(!n.heads||n.heads.length<1)throw new Error(`Can't serialize a log without heads`);return t.object.put(n.toBuffer()).then(t=>t.toJSON().multihash)}static fetchAll(t,n,e,i=[]){let u=[],s={},c=Array.isArray(n)?n.slice():[n];i.forEach(t=>{s[t]=!0});const a=()=>{return c.length>0&&(u.length<e||e<0)},f=()=>{const n=c.shift();return s[n]?Promise.resolve(u):r.fromMultihash(t,n).then(t=>{return t.next.forEach((t,n)=>c.push(t)),u.push(t),s[n]=!0,u})};return o(a,f).then(()=>u)}}t.exports=a}).call(n,e(0).Buffer)},function(t,n){function e(t){return r(t)||i(t)}function r(t){return t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array}function i(t){return u[o.call(t)]}t.exports=e,e.strict=r,e.loose=i;var o=Object.prototype.toString,u={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0}},function(t,n){var e={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==e.call(t)}},function(t,n,e){(function(n){t.exports=function(){function t(t,n){return function(r){return function(){e(t,n),r&&r.apply(null,arguments)}}}function e(n,e){var r=s[n].indexOf(e);~r&&(s[n].splice(r,1),o(n)?u(function(){s[n][0](t(n,s[n][0]))}):delete s[n])}function r(t,n){return o(t)?(s[t].push(n),!1):(s[t]=[n],!0)}function i(n,i){function o(t){return function(){var n=[].slice.call(arguments);for(var r in s)e(r,s[r]);t.apply(this,n)}}if(Array.isArray(n)){var u=n.length,s={};return void n.forEach(function(t){function n(){e++||--u||i(o)}var e=0;s[t]=n,r(t,n)&&n()})}r(n,i)&&i(t(n,i))}function o(t){return!!Array.isArray(s[t])&&!!s[t].length}var u="undefined"==typeof n?setTimeout:n,s={};return i.isLocked=o,i}}).call(n,e(6).setImmediate)},function(t,n,e){"use strict";(function(n){const r=e(75),i=e(74).format,o=e(5).EventEmitter;let u=!!n.version;const s={DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR",NONE:"NONE"};let c=s.DEBUG,a=null,f=new o,h={Black:0,Red:1,Green:2,Yellow:3,Blue:4,Magenta:5,Cyan:6,Grey:7,White:9,Default:9};u||(h={Black:"Black",Red:"IndianRed",Green:"LimeGreen",Yellow:"Orange",Blue:"RoyalBlue",Magenta:"Orchid",Cyan:"SkyBlue",Grey:"DimGrey",White:"White",Default:"Black"});const l=[h.Cyan,h.Green,h.Yellow,h.Red,h.Default],p={useColors:!0,color:h.Default,showTimestamp:!0,showLevel:!0,filename:a,appendFile:!0};class d{constructor(t,n){this.category=t;let e={};Object.assign(e,p),Object.assign(e,n),this.options=e}debug(){this._shouldLog(s.DEBUG)&&this._write(s.DEBUG,i.apply(null,arguments))}log(){this._shouldLog(s.DEBUG)&&this.debug.apply(this,arguments)}info(){this._shouldLog(s.INFO)&&this._write(s.INFO,i.apply(null,arguments))}warn(){this._shouldLog(s.WARN)&&this._write(s.WARN,i.apply(null,arguments))}error(){this._shouldLog(s.ERROR)&&this._write(s.ERROR,i.apply(null,arguments))}_write(t,n){(this.options.filename||a)&&!this.fileWriter&&u&&(this.fileWriter=r.openSync(this.options.filename||a,this.options.appendFile?"a+":"w+"));let e=this._format(t,n),i=this._createLogMessage(t,n),o=this._createLogMessage(t,n,e.timestamp,e.level,e.category,e.text);this.fileWriter&&u&&r.writeSync(this.fileWriter,i+"\n",null,"utf-8"),u||!this.options.useColors?(console.log(o),f.emit("data",this.category,t,n)):t===s.ERROR?this.options.showTimestamp&&this.options.showLevel?console.error(o,e.timestamp,e.level,e.category,e.text):this.options.showTimestamp&&!this.options.showLevel?console.error(o,e.timestamp,e.category,e.text):!this.options.showTimestamp&&this.options.showLevel?console.error(o,e.level,e.category,e.text):console.error(o,e.category,e.text):this.options.showTimestamp&&this.options.showLevel?console.log(o,e.timestamp,e.level,e.category,e.text):this.options.showTimestamp&&!this.options.showLevel?console.log(o,e.timestamp,e.category,e.text):!this.options.showTimestamp&&this.options.showLevel?console.log(o,e.level,e.category,e.text):console.log(o,e.category,e.text)}_format(t,n){let e="",r="",i="",o=": ";if(this.options.useColors){const n=Object.keys(s).map(t=>s[t]).indexOf(t),c=this.options.color;u?(this.options.showTimestamp&&(e="[3"+h.Grey+"m"),this.options.showLevel&&(r="[3"+l[n]+";22m"),i="[3"+c+";1m",o="[0m: "):(this.options.showTimestamp&&(e="color:"+h.Grey),this.options.showLevel&&(r="color:"+l[n]),i="color:"+c+"; font-weight: bold")}return{timestamp:e,level:r,category:i,text:o}}_createLogMessage(t,n,e,r,i,o){e=e||"",r=r||"",i=i||"",o=o||": ",!u&&this.options.useColors&&(this.options.showTimestamp&&(e="%c"),this.options.showLevel&&(r="%c"),i="%c",o=": %c");let c="";return this.options.showTimestamp&&(c+=""+(new Date).toISOString()+" "),c=e+c,this.options.showLevel&&(c+=r+"["+t+"]"+(t===s.INFO||t===s.WARN?" ":"")+" "),c+=i+this.category,c+=o+n}_shouldLog(t){let e="undefined"!=typeof n&&void 0!==n.env&&void 0!==n.env.LOG?n.env.LOG.toUpperCase():null;e="undefined"!=typeof window&&window.LOG?window.LOG.toUpperCase():e;const r=e||c,i=Object.keys(s).map(t=>s[t]),o=i.indexOf(t),u=i.indexOf(r);return o>=u}}t.exports={Colors:h,LogLevels:s,setLogLevel:t=>{c=t},setLogfile:t=>{a=t},create:(t,n)=>{const e=new d(t,n);return e},forceBrowserMode:t=>u=!t,events:f}}).call(n,e(7))},function(t,n){t.exports=function(t){return function n(e,r,i){var o=!0,u=!1;do u=!0,o=!1,t.call(function(t,s,c){u?(e=t,r=s,i=c,o=!0):n(t,s,c)},e,r,i),u=!1;while(o)}}},function(t,n,e){"use strict";(function(n){const r=e(13),i=e(27),o=e(33);class u{constructor(t,n=""){this.path=t||"./orbit-db",this.filename=n+"orbit.db",this._store=new i(this.path),this._cache={},this._lock=new o}get(t){return this._cache[t]}set(t,n){return new Promise((e,i)=>{return this._cache[t]===n?e(n):(this._cache[t]=n,void this._lock(this.filename,t=>{r(r.values([this._cache]),r.map(t=>JSON.stringify(t,null,2)),this._store.write(this.filename,t(t=>{return t?i(t):void e(n)})))}))})}load(){return this._cache={},new Promise((t,e)=>{this._store.exists(this.filename,(i,o)=>{return i||!o?t():void this._lock(this.filename,i=>{r(this._store.read(this.filename),r.collect(i((r,i)=>{if(r)return e(r);try{this._cache=JSON.parse(n.concat(i).toString()||"{}")}catch(t){return e(t)}t()})))})})})}reset(){this._cache={},this._store=null}}t.exports=u}).call(n,e(0).Buffer)},function(t,n,e){"use strict";const r=e(24);class i{constructor(t){this._counter=new r(t)}get(){return this._counter}updateIndex(t){this._counter&&t.items.filter(t=>t&&"COUNTER"===t.payload.op).map(t=>r.from(t.payload.value)).forEach(t=>this._counter.merge(t))}}t.exports=i},function(t,n,e){"use strict";class r{constructor(){this._index={}}get(t){return this._index[t]}updateIndex(t){t.items.slice().reverse().reduce((t,n)=>{return t.indexOf(n.payload.key)===-1&&(t.push(n.payload.key),"PUT"===n.payload.op?this._index[n.payload.key]=n.payload.value:"DEL"===n.payload.op&&delete this._index[n.payload.key]),t},[])}}t.exports=r},function(t,n,e){"use strict";class r{constructor(){this._index=[]}get(){return this._index}updateIndex(t){this._index=t.items}}t.exports=r},function(t,n,e){"use strict";class r{constructor(){this._index={}}get(){return Object.keys(this._index).map(t=>this._index[t])}updateIndex(t){t.items.reduce((t,n)=>{return t.includes(n.hash)||(t.push(n.hash),"ADD"===n.payload.op?this._index[n.hash]=n:"DEL"===n.payload.op&&delete this._index[n.payload.value]),t},[])}}t.exports=r},function(t,n,e){"use strict";class r{constructor(){this._index={}}get(t){return this._index[t]}updateIndex(t){t.items.slice().reverse().reduce((t,n)=>{return t.includes(n.payload.key)||(t.push(n.payload.key),"PUT"===n.payload.op?this._index[n.payload.key]=n.payload.value:"DEL"===n.payload.op&&delete this._index[n.payload.key]),t},[])}}t.exports=r},function(t,n,e){"use strict";(function(n){const r=e(34),i=r.create("orbit-db.ipfs-pubsub");r.setLogLevel("ERROR");
class o{constructor(t){this._ipfs=t,this._subscriptions={},null===this._ipfs.pubsub&&i.error("The provided version of ipfs doesn't have pubsub support. Messages will not be exchanged.")}subscribe(t,n){this._subscriptions[t]||(this._subscriptions[t]={onMessage:n},this._ipfs.pubsub&&this._ipfs.pubsub.subscribe(t,{discover:!0},this._handleMessage.bind(this)))}unsubscribe(t){this._subscriptions[t]&&(this._ipfs.pubsub.unsubscribe(t,this._handleMessage),delete this._subscriptions[t],i.debug(`Unsubscribed from '${t}'`))}publish(t,e){this._subscriptions[t]&&this._ipfs.pubsub&&this._ipfs.pubsub.publish(t,new n(JSON.stringify(e)))}disconnect(){Object.keys(this._subscriptions).forEach(t=>this.unsubscribe(t))}_handleMessage(t){if(t.from!==this._ipfs.PeerId){const n=t.topicCIDs[0],e=JSON.parse(t.data.toString()),r=this._subscriptions[n];r&&r.onMessage&&e&&r.onMessage(n,e)}}}t.exports=o}).call(n,e(0).Buffer)},function(t,n,e){"use strict";class r{constructor(t){this.id=t,this._index=[]}get(){return this._index}updateIndex(t,n){this._index=t.ops}}t.exports=r},function(t,n,e){"use strict";const r=t=>new Promise(n=>{n(t())});t.exports=((t,n)=>r(function e(){if(t())return r(n).then(e)}))},function(t,n){t.exports=function(t){function n(n){if(!n)throw new Error("must be passed a readable");e=n,r&&t(e)}var e,r=!1;Math.random();return n.resolve=n.ready=n.start=function(i){return r=!0,t=i||t,e&&t(e),n},n}},function(t,n){function e(t){function n(t,n){t&&(i=t,o&&r(i)),o=n,e()}function e(){o&&(i?r(i):!s.length&&u?r(u):s.length&&r(null,s.shift()))}function r(n,e){var r=o;if(n&&t){var i=t;t=null,i(n===!0?null:n)}o=null,r(n,e)}var i,o,u,s=[];return n.end=function(t){u=u||t||!0,e()},n.push=function(t){if(!u){if(o)return void r(i,t);s.push(t),e()}},n}t.exports=e},function(t,n,e){"use strict";t.exports=function t(n){var e=arguments.length;if("function"==typeof n&&1===n.length){for(var r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return function(n){if(null==r)throw new TypeError("partial sink should only be called once!");var i=r;switch(r=null,e){case 1:return t(n,i[0]);case 2:return t(n,i[0],i[1]);case 3:return t(n,i[0],i[1],i[2]);case 4:return t(n,i[0],i[1],i[2],i[3]);default:return i.unshift(n),t.apply(null,i)}}}var o=n;o&&"function"==typeof o.source&&(o=o.source);for(var i=1;i<e;i++){var u=arguments[i];"function"==typeof u?o=u(o):u&&"object"==typeof u&&(u.sink(o),o=u.source)}return o}},function(t,n,e){"use strict";var r=e(8);t.exports=function(t){return r(function(t,n){return t.push(n),t},[],t)}},function(t,n,e){"use strict";var r=e(8);t.exports=function(t){return r(function(t,n){return t+n},"",t)}},function(t,n,e){"use strict";function r(t){return t}var i=e(2),o=e(1);t.exports=function(t,n){var e=!1;return n?t=i(t)||r:(n=t,t=r),o(function(r){if(t(r))return e=!0,n(null,r),!1},function(t){e||n(t===!0?null:t,null)})}},function(t,n,e){"use strict";t.exports={drain:e(1),onEnd:e(53),log:e(52),find:e(50),reduce:e(8),collect:e(48),concat:e(49)}},function(t,n,e){"use strict";var r=e(1);t.exports=function(t){return r(function(t){console.log(t)},t)}},function(t,n,e){"use strict";var r=e(1);t.exports=function(t){return r(null,t)}},function(t,n,e){"use strict";t.exports=function(t){var n=0;return t=t||1/0,function(e,r){return e?r&&r(e):n>t?r(!0):void r(null,n++)}}},function(t,n,e){"use strict";t.exports=function(){return function(t,n){n(!0)}}},function(t,n,e){"use strict";t.exports=function(t){return function(n,e){e(t)}}},function(t,n,e){"use strict";t.exports={keys:e(59),once:e(14),values:e(9),count:e(54),infinite:e(58),empty:e(55),error:e(56)}},function(t,n,e){"use strict";t.exports=function(t){return t=t||Math.random,function(n,e){return n?e&&e(n):e(null,t())}}},function(t,n,e){"use strict";var r=e(9);t.exports=function(t){return r(Object.keys(t))}},function(t,n,e){"use strict";function r(t){return t}var i=e(2);t.exports=function(t){if(!t)return r;t=i(t);var n,e,o=!1;return function(r){return function i(u,s){return e?s(e):void(u?(e=u,o?r(u,function(){o?n=s:s(u)}):r(u,s)):r(null,function(r,u){r?s(r):e?s(e):(o=!0,t(u,function(t,r){o=!1,e?(s(e),n(e)):t?i(t,s):s(null,r)}))}))}}}},function(t,n,e){"use strict";var r=e(17),i=e(10);t.exports=function(t){return t=r(t),i(function(n){return!t(n)})}},function(t,n,e){"use strict";var r=e(9),i=e(14);t.exports=function(){return function(t){var n;return function(e,o){function u(){n(null,function(n,e){n===!0?s():n?t(!0,function(t){o(n)}):o(null,e)})}function s(){n=null,t(null,function(t,e){return t?o(t):(Array.isArray(e)||e&&"object"==typeof e?e=r(e):"function"!=typeof e&&(e=i(e)),n=e,void u())})}e?n?n(e,function(n){t(n||e,o)}):t(e,o):n?u():s()}}}},function(t,n,e){"use strict";t.exports={map:e(64),asyncMap:e(60),filter:e(10),filterNot:e(61),through:e(67),take:e(66),unique:e(15),nonUnique:e(65),flatten:e(62)}},function(t,n,e){"use strict";function r(t){return t}var i=e(2);t.exports=function(t){return t?(t=i(t),function(n){return function(e,r){n(e,function(e,i){try{i=e?null:t(i)}catch(t){return n(t,function(){return r(t)})}r(e,i)})}}):r}},function(t,n,e){"use strict";var r=e(15);t.exports=function(t){return r(t,!0)}},function(t,n,e){"use strict";t.exports=function(t,n){n=n||{};var e=n.last||!1,r=!1;if("number"==typeof t){e=!0;var i=t;t=function(){return--i}}return function(n){function i(t){n(!0,function(n){e=!1,t(n||!0)})}return function(o,u){r?e?i(u):u(r):(r=o)?n(r,u):n(null,function(n,o){(r=r||n)?u(r):t(o)?u(null,o):(r=!0,e?u(null,o):i(u))})}}}},function(t,n,e){"use strict";t.exports=function(t,n){function e(t){!r&&n&&(r=!0,n(t===!0?null:t))}var r=!1;return function(n){return function(r,i){return r&&e(r),n(r,function(n,r){n?e(n):t&&t(r),i(n,r)})}}}},function(t,n,e){var r=e(35),i=t.exports=function(t,n){return function(e){n=n||function(t,n){return{start:t,data:n}};var i=[],o=[],u=null,s=0;return function(c,a){if(o.length)return a(null,o.shift());if(u)return a(u);s++;e(c,r(function(r,s){function c(t,e){l||(l=!0,delete i[i.indexOf(f)],o.push(n(s,e)))}var f,h=this,l=!1;return r&&(u=r),u||(f=t(s,c)),f?i.push(f):l=!0,i.forEach(function(t,n){t(r,s)}),o.length?a(null,o.shift()):u?a(u):void e(null,h)}))}}};i.recent=function(t,n){var e=null;return i(function(r,i){function o(){var t=e;e=null,clearTimeout(u),i(null,t)}if(!e){e=[];var u;return n&&(u=setTimeout(o,n)),function(n,r){return n?o():(e.push(r),void(null!=t&&e.length>=t&&o()))}}},function(t,n){return n})},i.sliding=function(t,n){n=n||10;var e=0;return i(function(r,i){var o,u=0;e++;return function(e,r){e||(o=t(o,r),n<=++u&&i(null,o))}})}},function(t,n){function e(t,n){return(t=t||[]).push(n),t}t.exports=function(t,n,r,i){function o(e){function a(){v||u||(v=!0,e(null,function(t,n){v=!1,h(t,n)}))}function f(){if(!p){var n=l;l=null,p=!0,d=0,t(n,function(t){p=!1,u!==!0||d?u&&u!==!0?(i(u),s&&s()):t?e(u=t,i):d?f():a():i(t)})}}function h(t,e){u||(u=t,u?p||i(u===!0?null:u):(l=n(l,e),d=l&&l.length||0,null!=l&&f(),d<r&&a()))}var l=null,p=!1,d=0;if(c=e,u)return e(u,function(t){i(t),s&&s()});var v=!1;o.abort=function(t){s=function(n){t&&t()},e(u=new Error("aborted"),function(t){t=t===!0?null:t,p||(i&&i(t),s&&s(t))})},a()}n=n||e;var u,s,c;return o.abort=function(t){u=new Error("aborted before connecting"),s=function(n){t&&t()}},o}},function(t,n,e){(function(t,n){!function(t,e){"use strict";function r(t){"function"!=typeof t&&(t=new Function(""+t));for(var n=new Array(arguments.length-1),e=0;e<n.length;e++)n[e]=arguments[e+1];var r={callback:t,args:n};return v[d]=r,p(d),d++}function i(t){delete v[t]}function o(t){var n=t.callback,r=t.args;switch(r.length){case 0:n();break;case 1:n(r[0]);break;case 2:n(r[0],r[1]);break;case 3:n(r[0],r[1],r[2]);break;default:n.apply(e,r)}}function u(t){if(y)setTimeout(u,0,t);else{var n=v[t];if(n){y=!0;try{o(n)}finally{i(t),y=!1}}}}function s(){p=function(t){n.nextTick(function(){u(t)})}}function c(){if(t.postMessage&&!t.importScripts){var n=!0,e=t.onmessage;return t.onmessage=function(){n=!1},t.postMessage("","*"),t.onmessage=e,n}}function a(){var n="setImmediate$"+Math.random()+"$",e=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(n)&&u(+e.data.slice(n.length))};t.addEventListener?t.addEventListener("message",e,!1):t.attachEvent("onmessage",e),p=function(e){t.postMessage(n+e,"*")}}function f(){var t=new MessageChannel;t.port1.onmessage=function(t){var n=t.data;u(n)},p=function(n){t.port2.postMessage(n)}}function h(){var t=g.documentElement;p=function(n){var e=g.createElement("script");e.onreadystatechange=function(){u(n),e.onreadystatechange=null,t.removeChild(e),e=null},t.appendChild(e)}}function l(){p=function(t){setTimeout(u,0,t)}}if(!t.setImmediate){var p,d=1,v={},y=!1,g=t.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(t);m=m&&m.setTimeout?m:t,"[object process]"==={}.toString.call(t.process)?s():c()?a():t.MessageChannel?f():g&&"onreadystatechange"in g.createElement("script")?h():l(),m.setImmediate=r,m.clearImmediate=i}}("undefined"==typeof self?"undefined"==typeof t?this:t:self)}).call(n,e(4),e(7))},function(t,n,e){(function(n){var r=e(31).strict;t.exports=function(t){if(r(t)){var e=new n(t.buffer);return t.byteLength!==t.buffer.byteLength&&(e=e.slice(t.byteOffset,t.byteOffset+t.byteLength)),e}return new n(t)}}).call(n,e(0).Buffer)},function(t,n){"function"==typeof Object.create?t.exports=function(t,n){t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,n){t.super_=n;var e=function(){};e.prototype=n.prototype,t.prototype=new e,t.prototype.constructor=t}},function(t,n){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,n,e){(function(t,r){function i(t,e){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),v(e)?r.showHidden=e:e&&n._extend(r,e),_(r.showHidden)&&(r.showHidden=!1),_(r.depth)&&(r.depth=2),_(r.colors)&&(r.colors=!1),_(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),c(r,t,r.depth)}function o(t,n){var e=i.styles[n];return e?"["+i.colors[e][0]+"m"+t+"["+i.colors[e][1]+"m":t}function u(t,n){return t}function s(t){var n={};return t.forEach(function(t,e){n[t]=!0}),n}function c(t,e,r){if(t.customInspect&&e&&O(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(r,t);return b(i)||(i=c(t,i,r)),i}var o=a(t,e);if(o)return o;var u=Object.keys(e),v=s(u);if(t.showHidden&&(u=Object.getOwnPropertyNames(e)),A(e)&&(u.indexOf("message")>=0||u.indexOf("description")>=0))return f(e);if(0===u.length){if(O(e)){var y=e.name?": "+e.name:"";return t.stylize("[Function"+y+"]","special")}if(x(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(k(e))return t.stylize(Date.prototype.toString.call(e),"date");if(A(e))return f(e)}var g="",m=!1,w=["{","}"];if(d(e)&&(m=!0,w=["[","]"]),O(e)){var _=e.name?": "+e.name:"";g=" [Function"+_+"]"}if(x(e)&&(g=" "+RegExp.prototype.toString.call(e)),k(e)&&(g=" "+Date.prototype.toUTCString.call(e)),A(e)&&(g=" "+f(e)),0===u.length&&(!m||0==e.length))return w[0]+g+w[1];if(r<0)return x(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var E;return E=m?h(t,e,r,v,u):u.map(function(n){return l(t,e,r,v,n,m)}),t.seen.pop(),p(E,g,w)}function a(t,n){if(_(n))return t.stylize("undefined","undefined");if(b(n)){var e="'"+JSON.stringify(n).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(e,"string")}return m(n)?t.stylize(""+n,"number"):v(n)?t.stylize(""+n,"boolean"):y(n)?t.stylize("null","null"):void 0}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,n,e,r,i){for(var o=[],u=0,s=n.length;u<s;++u)j(n,String(u))?o.push(l(t,n,e,r,String(u),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(l(t,n,e,r,i,!0))}),o}function l(t,n,e,r,i,o){var u,s,a;if(a=Object.getOwnPropertyDescriptor(n,i)||{value:n[i]},a.get?s=a.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):a.set&&(s=t.stylize("[Setter]","special")),j(r,i)||(u="["+i+"]"),s||(t.seen.indexOf(a.value)<0?(s=y(e)?c(t,a.value,null):c(t,a.value,e-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n"))):s=t.stylize("[Circular]","special")),_(u)){if(o&&i.match(/^\d+$/))return s;u=JSON.stringify(""+i),u.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(u=u.substr(1,u.length-2),u=t.stylize(u,"name")):(u=u.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),u=t.stylize(u,"string"))}return u+": "+s}function p(t,n,e){var r=0,i=t.reduce(function(t,n){return r++,n.indexOf("\n")>=0&&r++,t+n.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?e[0]+(""===n?"":n+"\n ")+" "+t.join(",\n  ")+" "+e[1]:e[0]+n+" "+t.join(", ")+" "+e[1]}function d(t){return Array.isArray(t)}function v(t){return"boolean"==typeof t}function y(t){return null===t}function g(t){return null==t}function m(t){return"number"==typeof t}function b(t){return"string"==typeof t}function w(t){return"symbol"==typeof t}function _(t){return void 0===t}function x(t){return E(t)&&"[object RegExp]"===S(t)}function E(t){return"object"==typeof t&&null!==t}function k(t){return E(t)&&"[object Date]"===S(t)}function A(t){return E(t)&&("[object Error]"===S(t)||t instanceof Error)}function O(t){return"function"==typeof t}function T(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function S(t){return Object.prototype.toString.call(t)}function P(t){return t<10?"0"+t.toString(10):t.toString(10)}function I(){var t=new Date,n=[P(t.getHours()),P(t.getMinutes()),P(t.getSeconds())].join(":");return[t.getDate(),C[t.getMonth()],n].join(" ")}function j(t,n){return Object.prototype.hasOwnProperty.call(t,n)}var R=/%[sdj%]/g;n.format=function(t){if(!b(t)){for(var n=[],e=0;e<arguments.length;e++)n.push(i(arguments[e]));return n.join(" ")}for(var e=1,r=arguments,o=r.length,u=String(t).replace(R,function(t){if("%%"===t)return"%";if(e>=o)return t;switch(t){case"%s":return String(r[e++]);case"%d":return Number(r[e++]);case"%j":try{return JSON.stringify(r[e++])}catch(t){return"[Circular]"}default:return t}}),s=r[e];e<o;s=r[++e])u+=y(s)||!E(s)?" "+s:" "+i(s);return u},n.deprecate=function(e,i){function o(){if(!u){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),u=!0}return e.apply(this,arguments)}if(_(t.process))return function(){return n.deprecate(e,i).apply(this,arguments)};if(r.noDeprecation===!0)return e;var u=!1;return o};var D,B={};n.debuglog=function(t){if(_(D)&&(D=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!B[t])if(new RegExp("\\b"+t+"\\b","i").test(D)){var e=r.pid;B[t]=function(){var r=n.format.apply(n,arguments);console.error("%s %d: %s",t,e,r)}}else B[t]=function(){};return B[t]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=v,n.isNull=y,n.isNullOrUndefined=g,n.isNumber=m,n.isString=b,n.isSymbol=w,n.isUndefined=_,n.isRegExp=x,n.isObject=E,n.isDate=k,n.isError=A,n.isFunction=O,n.isPrimitive=T,n.isBuffer=e(73);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",I(),n.format.apply(n,arguments))},n.inherits=e(72),n._extend=function(t,n){if(!n||!E(n))return t;for(var e=Object.keys(n),r=e.length;r--;)t[e[r]]=n[e[r]];return t}}).call(n,e(4),e(7))},function(t,n){},function(t,n,e){"use strict";(function(n){const r=e(5).EventEmitter,i=e(11),o=e(20),u=e(21),s=e(18),c=e(19),a=e(22),f="Orbit DEV Network";class h{constructor(t,n="default",e={}){this._ipfs=t,this._pubsub=e&&e.broker?new e.broker(t):new a(t),this.user={id:n},this.network={name:f},this.events=new r,this.stores={}}feed(t,n){return this._createStore(o,t,n)}eventlog(t,n){return this._createStore(i,t,n)}kvstore(t,n){return this._createStore(u,t,n)}counter(t,n){return this._createStore(s,t,n)}docstore(t,n){return this._createStore(c,t,n)}close(t){this._pubsub&&this._pubsub.unsubscribe(t),delete this.stores[t]}disconnect(){this._pubsub&&this._pubsub.disconnect(),Object.keys(this.stores).map(t=>this.stores[t]).forEach(t=>t.events.removeAllListeners("write")),this.stores={},this.user=null,this.network=null}_createStore(t,n,e){const r=Object.assign({replicate:!0},e),i=new t(this._ipfs,this.user.id,n,r);return i.events.on("write",this._onWrite.bind(this)),this.stores[n]=i,r.replicate&&this._pubsub&&this._pubsub.subscribe(n,this._onMessage.bind(this)),i}_onMessage(t,n){const e=this.stores[t];e.sync(n)}_onWrite(t,e,r,i){if(!i)throw new Error("'heads' not defined");this._pubsub&&n(()=>this._pubsub.publish(t,i))}}t.exports=h}).call(n,e(6).setImmediate)}]);
//# sourceMappingURL=orbitdb.min.js.map